(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{wXy8:function(t,o,n){"use strict";n.r(o),n.d(o,"ROUTES",function(){return Mt}),n.d(o,"AdminBookingModule",function(){return Rt});var e=n("/e7+"),i=n("FJeW"),r=n("Sa+r"),c=n("ITiG"),l=n("0sMf"),a=n("8Y7J"),b=n("iInd"),s=n("G0yt"),u=n("SVse"),d=n("/YPm"),g=n("yBZE"),f=n("53Co"),h=n("HF3I"),m=function(){return(m=Object.assign||function(t){for(var o,n=1,e=arguments.length;n<e;n++)for(var i in o=arguments[n])Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);return t}).apply(this,arguments)};function p(t,o){if(1&t){var n=a.Rb();a.Qb(0,"span"),a.Qb(1,"button",16),a.bc("click",function(){a.wc(n);var t=o.$implicit;return a.dc(2).onSelectCategory(t)}),a.Fc(2),a.Pb(),a.Pb()}if(2&t){var e=o.$implicit,i=a.dc(2);a.zb(1),a.lc("ngClass",e==i.category?"btn-primary":"btn-secondary"),a.zb(1),a.Hc(" ",e," ")}}var v=function(t,o){return{disabled:t,selected:o}};function k(t,o){if(1&t){var n=a.Rb();a.Qb(0,"div",17),a.Qb(1,"div",18),a.bc("click",function(){a.wc(n);var t=o.$implicit;return a.dc(2).onRoomSelect(t.id,t.available)}),a.Fc(2),a.Pb(),a.Pb()}if(2&t){var e=o.$implicit;a.zb(1),a.lc("ngClass",a.qc(2,v,!e.available,e.selected)),a.zb(1),a.Hc(" ",e.roomNumber," ")}}function y(t,o){if(1&t&&(a.Qb(0,"div"),a.Qb(1,"div",11),a.Qb(2,"div",12),a.Qb(3,"h4"),a.Fc(4),a.Pb(),a.Pb(),a.Dc(5,p,3,2,"span",13),a.Pb(),a.Qb(6,"div",14),a.Dc(7,k,3,5,"div",15),a.Pb(),a.Pb()),2&t){var n=a.dc();a.zb(4),a.Gc(n.hotel.name),a.zb(1),a.lc("ngForOf",n.categoryList),a.zb(2),a.lc("ngForOf",n.filteredRoomList)}}function P(t,o){if(1&t&&a.Mb(0,"loading",19),2&t){var n=a.dc();a.lc("message",n.message)}}var Q=function(){function t(t,o){this.roomService=t,this.util=o,this.showHotels=new a.n,this.roomSelected=new a.n,this.daterange={},this.showRoomListLoading=!1,this.message=""}return t.prototype.ngOnInit=function(){this.setDateRanges(),this.hotel&&this.getAdminAvailableRoomList(this.hotel.id,this.daterange.checkinDate,this.daterange.checkoutDate)},t.prototype.ngOnChanges=function(t){var o=this;if(t.unSelect&&t.unSelect.currentValue&&this.roomList&&this.roomList.length>0){var n=this.roomList.find(function(t){return t.id===o.unSelect}),e=m(m({},n),{selected:!1});this.roomList.splice(this.roomList.findIndex(function(t){return t.id==o.unSelect}),1,e)}t.reloadRoomList&&this.daterange&&this.daterange.checkinDate&&this.daterange.checkoutDate&&this.reload(this.hotel.id,this.daterange.checkinDate,this.daterange.checkoutDate)},t.prototype.setDateRanges=function(){this.daterange.checkinDate=new Date,this.daterange.checkoutDate=new Date,this.daterange.checkoutDate.setDate(this.daterange.checkoutDate.getDate()+1);var t=new Date;t.setDate(this.daterange.checkinDate.getDate()+90);var o=new Date;o.setDate(this.daterange.checkinDate.getDate()-60),this.options={autoApply:!0,locale:{format:"DD MMM,YY"},minDate:o,maxDate:t,startDate:this.daterange.checkinDate,endDate:this.daterange.checkoutDate,alwaysShowCalendars:!1}},t.prototype.selectedDate=function(t){this.daterange.checkinDate=t.start._d,this.daterange.checkoutDate=t.end._d,this.daterange.label=t.label,this.getAdminAvailableRoomList(this.hotel.id,this.daterange.checkinDate,this.daterange.checkoutDate)},t.prototype.reload=function(t,o,n){this.getAdminAvailableRoomList(t,o,n)},t.prototype.getAdminAvailableRoomList=function(t,o,n,e){return void 0===e&&(e=null),i=this,void 0,c=function(){var i,r,c=this;return function(t,o){var n,e,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,e&&(i=2&r[0]?e.return:r[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,r[1])).done)return i;switch(e=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,e=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=o.call(t,c)}catch(l){r=[6,l],e=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}}(this,function(l){switch(l.label){case 0:return i=this.util.getDateString(o),r=this.util.getDateString(n),this.showRoomListLoading=!0,this.message="Room List loading",[4,this.roomService.getAdminAvailableRoomListByHotelId(t,i,r,e).subscribe(function(t){c.showRoomListLoading=!1,c.roomList=t,c.filteredRoomList=t,c.category="All",c.categoryList=["All"],c.roomList.forEach(function(t){c.categoryList.includes(t.category.name)||c.categoryList.push(t.category.name)})})];case 1:return l.sent(),[2]}})},new((r=void 0)||(r=Promise))(function(t,o){function n(t){try{l(c.next(t))}catch(n){o(n)}}function e(t){try{l(c.throw(t))}catch(n){o(n)}}function l(o){var i;o.done?t(o.value):(i=o.value,i instanceof r?i:new r(function(t){t(i)})).then(n,e)}l((c=c.apply(i,[])).next())});var i,r,c},t.prototype.onSelectCategory=function(t){this.category=t,this.filteredRoomList="All"==t?this.roomList:this.roomList.filter(function(o){return o.category.name==t})},t.prototype.onRoomSelect=function(t,o){if(o){var n=this.roomList.find(function(o){return o.id===t}),e=m({selected:!0},n);this.roomList.splice(this.roomList.findIndex(function(o){return o.id==t}),1,e);var i={room:n,checkInDate:new Date(this.daterange.checkinDate),checkOutDate:new Date(this.daterange.checkoutDate)};this.roomSelected.emit(i)}},t.prototype.onHotelList=function(){this.showHotels.emit(!0)},t.\u0275fac=function(o){return new(o||t)(a.Lb(g.a),a.Lb(e.a))},t.\u0275cmp=a.Fb({type:t,selectors:[["admin-available-room-list"]],inputs:{hotel:"hotel",unSelect:"unSelect",reloadRoomList:"reloadRoomList"},outputs:{showHotels:"showHotels",roomSelected:"roomSelected"},features:[a.xb],decls:13,vars:3,consts:[[1,"container-fluid"],[1,"row"],[1,"col-9"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"fa","fa-calendar"],["type","text","name","daterangeInput","daterangepicker","",1,"form-control",3,"options","selected"],[4,"ngIf","ngIfElse"],["roomListLoading",""],[1,"btn","btn-sm","btn-info",3,"click"],[1,"row","mt-1"],[1,"col-12"],[4,"ngFor","ngForOf"],[1,"row","m-0"],["class","col-md-2 col-4 p-0",4,"ngFor","ngForOf"],[1,"btn-sm","m-1",3,"ngClass","click"],[1,"col-md-2","col-4","p-0"],[1,"room-box",3,"ngClass","click"],[3,"message"]],template:function(t,o){if(1&t&&(a.Qb(0,"div",0),a.Qb(1,"div",1),a.Qb(2,"div",2),a.Qb(3,"div",3),a.Qb(4,"div",4),a.Qb(5,"div",5),a.Mb(6,"i",6),a.Pb(),a.Pb(),a.Qb(7,"input",7),a.bc("selected",function(t){return o.selectedDate(t)}),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Dc(8,y,8,3,"div",8),a.Dc(9,P,1,1,"ng-template",null,9,a.Ec),a.Qb(11,"button",10),a.bc("click",function(){return o.onHotelList()}),a.Fc(12," Back to hotel list "),a.Pb(),a.Pb()),2&t){var n=a.vc(10);a.zb(7),a.lc("options",o.options),a.zb(1),a.lc("ngIf",!o.showRoomListLoading)("ngIfElse",n)}},directives:[f.b,u.q,u.p,u.o,h.a],styles:[".room-box[_ngcontent-%COMP%]{cursor:pointer;padding:5px;border:1px solid grey;border-radius:5px;text-align:center;margin:10px 10px 10px 0}.disabled[_ngcontent-%COMP%]{cursor:not-allowed;background-color:#d3d3d3!important}.selected[_ngcontent-%COMP%]{background-color:#90ee90;color:#fff}"]}),t}(),w=n("s7LF");function D(t,o){1&t&&(a.Qb(0,"small",12),a.Fc(1," Name required "),a.Pb())}function S(t,o){if(1&t&&(a.Qb(0,"small",12),a.Qb(1,"div",13),a.Fc(2," Phone number required "),a.Pb(),a.Qb(3,"div",13),a.Fc(4," Phone number format 01934953023 "),a.Pb(),a.Pb()),2&t){var n=a.dc();a.zb(1),a.lc("hidden",!n.form.controls.phoneNumber.errors.required),a.zb(2),a.lc("hidden",!n.form.controls.phoneNumber.errors.pattern)}}var F=function(t){return{disabled:t}},M=function(){function t(t){this.builder=t,this.user=new a.n}return t.prototype.ngOnInit=function(){this.createForm()},t.prototype.createForm=function(){this.form=this.builder.group({name:["",w.v.required],phoneNumber:["",[w.v.required,w.v.pattern("^01[3-9][ ]?[0-9]{2}[ ]?[0-9]{3}[ ]?[0-9]{3}$")]],email:""})},t.prototype.submit=function(){this.form.valid&&(this.user.emit(this.form.value),this.form.reset())},t.\u0275fac=function(o){return new(o||t)(a.Lb(w.d))},t.\u0275cmp=a.Fb({type:t,selectors:[["admin-user-form"]],outputs:{user:"user"},decls:21,vars:6,consts:[[3,"formGroup","ngSubmit"],[1,"form-row"],[1,"form-group","col-md-6"],["for","name"],["id","name","placeholder","Name","formControlName","name",1,"form-control"],["class","text-danger",4,"ngIf"],["for","phone"],["placeholder","Phone","id","phone","maxlength","11","formControlName","phoneNumber",1,"form-control"],["for","email"],["type","email","id","email","placeholder","Email","formControlName","email",1,"form-control"],[1,"d-flex","flex-row-reverse","bd-highlight","my-2","mb-5"],["type","submit",1,"btn","btn-primary","mx-1",3,"ngClass"],[1,"text-danger"],[3,"hidden"]],template:function(t,o){1&t&&(a.Qb(0,"h4"),a.Fc(1,"User Info"),a.Pb(),a.Qb(2,"form",0),a.bc("ngSubmit",function(){return o.submit()}),a.Qb(3,"div",1),a.Qb(4,"div",2),a.Qb(5,"label",3),a.Fc(6,"Name *"),a.Pb(),a.Mb(7,"input",4),a.Dc(8,D,2,0,"small",5),a.Pb(),a.Qb(9,"div",2),a.Qb(10,"label",6),a.Fc(11,"Phone *"),a.Pb(),a.Mb(12,"input",7),a.Dc(13,S,5,2,"small",5),a.Pb(),a.Qb(14,"div",2),a.Qb(15,"label",8),a.Fc(16,"Email"),a.Pb(),a.Mb(17,"input",9),a.Pb(),a.Pb(),a.Qb(18,"div",10),a.Qb(19,"button",11),a.Fc(20," Submit "),a.Pb(),a.Pb(),a.Pb()),2&t&&(a.zb(2),a.lc("formGroup",o.form),a.zb(6),a.lc("ngIf",o.form.controls.name.errors&&o.form.controls.name.touched),a.zb(5),a.lc("ngIf",o.form.controls.phoneNumber.errors&&o.form.controls.phoneNumber.touched),a.zb(6),a.lc("ngClass",a.pc(4,F,o.form.invalid)))},directives:[w.x,w.n,w.g,w.b,w.m,w.f,u.q,w.j,u.o],styles:[""]}),t}(),R=function(){return(R=Object.assign||function(t){for(var o,n=1,e=arguments.length;n<e;n++)for(var i in o=arguments[n])Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);return t}).apply(this,arguments)};function B(t,o){if(1&t){var n=a.Rb();a.Qb(0,"admin-hotel-list",5),a.bc("hotel",function(t){return a.wc(n),a.dc().onHotel(t)}),a.Pb()}}function x(t,o){if(1&t){var n=a.Rb();a.Qb(0,"div",6),a.Qb(1,"div",7),a.Qb(2,"div",8),a.Qb(3,"div",9),a.bc("click",function(){return a.wc(n),a.vc(7).toggle()}),a.Qb(4,"div",10),a.Mb(5,"i",11),a.Pb(),a.Pb(),a.Qb(6,"input",12,13),a.bc("ngModelChange",function(t){return a.wc(n),a.dc().dd=t})("dateSelect",function(){a.wc(n);var t=a.dc();return t.getAdminBookingList(t.hotelId,t.dd)})("click",function(){return a.wc(n),a.vc(7).toggle()}),a.Pb(),a.Pb(),a.Pb(),a.Pb()}if(2&t){var e=a.dc();a.zb(6),a.lc("ngModel",e.dd)("minDate",e.minDate)("maxDate",e.maxDate)}}var I=function(t,o,n,e,i){return{"bg-lightgray":t,"bg-yellow":o,"bg-green":n,"bg-red":e,"bg-white":i}};function L(t,o){if(1&t){var n=a.Rb();a.Qb(0,"div",17),a.Qb(1,"div",18),a.bc("click",function(){a.wc(n);var t=o.$implicit,e=a.dc(2);return e.onRoomClick(t.id,t.bookingId,e.dd)}),a.Fc(2),a.Mb(3,"br"),a.Pb(),a.Pb()}if(2&t){var e=o.$implicit;a.zb(1),a.lc("ngClass",a.tc(2,I,"ROOM_BLOCKED"===e.status,"ROOM_BOOKED"===e.status,"ROOM_RESERVED"===e.status,"ROOM_SOLD"===e.status,"ROOM_FREE"===e.status)),a.zb(1),a.Hc(" ",e.roomNumber," ")}}function O(t,o){if(1&t&&(a.Qb(0,"div",14),a.Qb(1,"div",15),a.Qb(2,"h4"),a.Fc(3),a.Pb(),a.Pb(),a.Dc(4,L,4,8,"div",16),a.Pb()),2&t){var n=a.dc();a.zb(3),a.Gc(n.hotel.name),a.zb(1),a.lc("ngForOf",n.roomList)}}function z(t,o){1&t&&(a.Qb(0,"div",19),a.Qb(1,"div",20),a.Mb(2,"div",21),a.Fc(3," Blocked "),a.Pb(),a.Qb(4,"div",20),a.Mb(5,"div",22),a.Fc(6," Reserved "),a.Pb(),a.Qb(7,"div",20),a.Mb(8,"div",23),a.Fc(9," Sold "),a.Pb(),a.Qb(10,"div",20),a.Mb(11,"div",24),a.Fc(12," Free "),a.Pb(),a.Pb())}function C(t,o){if(1&t){var n=a.Rb();a.Qb(0,"button",25),a.bc("click",function(){return a.wc(n),a.dc().onHotelList()}),a.Mb(1,"i",26),a.Fc(2," Back to hotel list\n"),a.Pb()}}var A=function(){function t(t){this.roomService=t,this.roomSelected=new a.n,this.loading=!1,this.showRoomList=!1}return t.prototype.ngOnChanges=function(t){t.reload&&this.dd&&this.getAdminBookingList(this.hotelId,this.dd)},t.prototype.ngOnInit=function(){var t=new Date;this.dd={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()},this.minDate={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()-60},this.maxDate={year:t.getFullYear(),month:t.getMonth()+4,day:t.getDate()},this.maxDate.month>12&&(this.maxDate.year+=1,this.maxDate.month-=12)},t.prototype.getAdminBookingList=function(t,o){return n=this,void 0,i=function(){var n=this;return function(t,o){var n,e,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,e&&(i=2&r[0]?e.return:r[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,r[1])).done)return i;switch(e=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,e=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=o.call(t,c)}catch(l){r=[6,l],e=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}}(this,function(e){switch(e.label){case 0:return this.loading=!0,[4,this.roomService.getAdminBookingList(t,this.makeDateString(o)).subscribe(function(t){n.roomList=t,n.loading=!1})];case 1:return e.sent(),[2]}})},new((e=void 0)||(e=Promise))(function(t,o){function r(t){try{l(i.next(t))}catch(n){o(n)}}function c(t){try{l(i.throw(t))}catch(n){o(n)}}function l(o){var n;o.done?t(o.value):(n=o.value,n instanceof e?n:new e(function(t){t(n)})).then(r,c)}l((i=i.apply(n,[])).next())});var n,e,i},t.prototype.onRoomClick=function(t,o,n){if(o>0){var e=this.roomList.find(function(o){return o.id==t});this.status=e.status;var i=R({date:n.year+"-"+(n.month+1)+"-"+n.day},e);this.roomSelected.emit(i)}},t.prototype.onHotel=function(t){this.hotelId=t.id,this.hotel=t,this.getAdminBookingList(t.id,this.dd),this.showRoomList=!0},t.prototype.onHotelList=function(){this.showRoomList=!1,localStorage.removeItem("hotelId")},t.prototype.makeDateString=function(t){return t.year+"-"+(t.month<10?"0"+t.month:t.month)+"-"+(t.day<10?"0"+t.day:t.day)},t.\u0275fac=function(o){return new(o||t)(a.Lb(g.a))},t.\u0275cmp=a.Fb({type:t,selectors:[["admin-room-status-date"]],inputs:{reload:"reload"},outputs:{roomSelected:"roomSelected"},features:[a.xb],decls:5,vars:5,consts:[[3,"hotel",4,"ngIf"],["class","row my-2",4,"ngIf"],["class","row",4,"ngIf"],["class","row border m-0 py-2",4,"ngIf"],["class","btn btn-sm btn-info mt-1",3,"click",4,"ngIf"],[3,"hotel"],[1,"row","my-2"],[1,"col-auto"],[1,"input-group","mb-2"],[1,"input-group-prepend",3,"click"],[1,"input-group-text"],[1,"fa","fa-calendar"],["placeholder","yyyy-mm-dd","name","dp","ngbDatepicker","",1,"form-control",3,"ngModel","minDate","maxDate","ngModelChange","dateSelect","click"],["date","ngbDatepicker"],[1,"row"],[1,"col-12"],["class","col-md-2 col-sm-3 col-3 p-1",4,"ngFor","ngForOf"],[1,"col-md-2","col-sm-3","col-3","p-1"],[1,"room-map-box",3,"ngClass","click"],[1,"row","border","m-0","py-2"],[1,"col-3"],[1,"foo","bg-lightgray"],[1,"foo","bg-green"],[1,"foo","bg-red"],[1,"foo","bg-white"],[1,"btn","btn-sm","btn-info","mt-1",3,"click"],[1,"fa","fa-chevron-left"]],template:function(t,o){1&t&&(a.Dc(0,B,1,0,"admin-hotel-list",0),a.Dc(1,x,8,3,"div",1),a.Dc(2,O,5,2,"div",2),a.Dc(3,z,13,0,"div",3),a.Dc(4,C,3,0,"button",4)),2&t&&(a.lc("ngIf",!o.showRoomList),a.zb(1),a.lc("ngIf",o.showRoomList),a.zb(1),a.lc("ngIf",o.showRoomList),a.zb(1),a.lc("ngIf",null==o.roomList?null:o.roomList.length),a.zb(1),a.lc("ngIf",o.showRoomList))},directives:[u.q,d.a,s.g,w.b,w.m,w.p,u.p,u.o],styles:[".room-map-box[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:10px;padding:5px;text-align:center;border:1px solid grey;border-radius:5px}.room-map-box[_ngcontent-%COMP%]:hover{border:1px solid #4f71e0}.bg-lightgray[_ngcontent-%COMP%]{background-color:#d3d3d3!important}.bg-yellow[_ngcontent-%COMP%]{background-color:#ff0!important}.bg-green[_ngcontent-%COMP%]{color:#fff;background-color:green!important}.bg-red[_ngcontent-%COMP%]{color:#fff;background-color:red!important}.bg-white[_ngcontent-%COMP%]{background-color:#fff!important}.foo[_ngcontent-%COMP%]{float:left;width:20px;height:20px;margin:5px;border:1px solid grey}"]}),t}(),H=n("Xtf6"),_=n("V9jR"),E=function(){return(E=Object.assign||function(t){for(var o,n=1,e=arguments.length;n<e;n++)for(var i in o=arguments[n])Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);return t}).apply(this,arguments)},N=function(t,o,n,e){return new(n||(n=Promise))(function(i,r){function c(t){try{a(e.next(t))}catch(o){r(o)}}function l(t){try{a(e.throw(t))}catch(o){r(o)}}function a(t){var o;t.done?i(t.value):(o=t.value,o instanceof n?o:new n(function(t){t(o)})).then(c,l)}a((e=e.apply(t,o||[])).next())})},T=function(t,o){var n,e,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,e&&(i=2&r[0]?e.return:r[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,r[1])).done)return i;switch(e=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,e=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=o.call(t,c)}catch(l){r=[6,l],e=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}};function G(t,o){if(1&t){var n=a.Rb();a.Qb(0,"admin-hotel-list",14),a.bc("hotel",function(t){return a.wc(n),a.dc(2).onHotel(t)}),a.Pb()}}function q(t,o){if(1&t){var n=a.Rb();a.Qb(0,"admin-available-room-list",15),a.bc("showHotels",function(t){return a.wc(n),a.dc(2).onShowHotels(t)})("roomSelected",function(t){return a.wc(n),a.dc(2).onRoomSelect(t)}),a.Pb()}if(2&t){var e=a.dc(2);a.lc("hotel",e.hotel)("unSelect",e.unSelect)("reloadRoomList",e.reloadRoomList)}}function $(t,o){1&t&&(a.Qb(0,"th",38),a.Fc(1," Commission "),a.Pb())}function j(t,o){if(1&t){var n=a.Rb();a.Qb(0,"td"),a.Qb(1,"input",47),a.bc("ngModelChange",function(t){return a.wc(n),a.dc().$implicit.commission=t}),a.Pb(),a.Pb()}if(2&t){var e=a.dc().$implicit;a.zb(1),a.lc("ngModel",e.commission)}}function V(t,o){if(1&t){var n=a.Rb();a.Qb(0,"tr"),a.Qb(1,"td"),a.Fc(2),a.Pb(),a.Qb(3,"td"),a.Fc(4),a.Pb(),a.Qb(5,"td"),a.Fc(6),a.Pb(),a.Qb(7,"td",38),a.Fc(8),a.Pb(),a.Qb(9,"td",38),a.Fc(10),a.Pb(),a.Qb(11,"td"),a.Qb(12,"input",43),a.bc("ngModelChange",function(t){return a.wc(n),o.$implicit.discount=t})("keyup",function(){a.wc(n);var t=o.index;return a.dc(4).updateSubBooking(t)}),a.Pb(),a.Pb(),a.Qb(13,"td",38),a.Fc(14),a.ec(15,"number"),a.Pb(),a.Qb(16,"td",38),a.Qb(17,"input",44),a.bc("ngModelChange",function(t){return a.wc(n),o.$implicit.advance=t})("keyup",function(){a.wc(n);var t=o.index;return a.dc(4).updateSubBooking(t)}),a.Pb(),a.Pb(),a.Qb(18,"td",38),a.Fc(19),a.Pb(),a.Dc(20,j,2,1,"td",42),a.Qb(21,"td"),a.Qb(22,"button",45),a.bc("click",function(){a.wc(n);var t=o.index;return a.dc(4).onRemove(t)}),a.Mb(23,"i",46),a.Pb(),a.Pb(),a.Pb()}if(2&t){var e=o.$implicit,i=a.dc(4);a.zb(2),a.Gc(e.room.category.hotel.name),a.zb(2),a.Gc(e.date),a.zb(2),a.Ic("",e.room.roomNumber," [",e.room.category.name,"]"),a.zb(2),a.Gc(e.room.price),a.zb(2),a.Hc("",e.room.vatService," %"),a.zb(2),a.lc("ngModel",e.discount),a.zb(2),a.Hc(" ",a.gc(15,11,e.payablePrice,"1.1-2")," "),a.zb(3),a.lc("ngModel",e.advance),a.zb(2),a.Gc(null==e?null:e.due),a.zb(1),a.lc("ngIf",(null==i.refBy?null:i.refBy.length)>0)}}function Y(t,o){1&t&&a.Mb(0,"td")}function J(t,o){1&t&&a.Mb(0,"td")}function U(t,o){1&t&&a.Mb(0,"td")}function K(t,o){1&t&&a.Mb(0,"td")}function X(t,o){if(1&t&&(a.Qb(0,"table",37),a.Qb(1,"thead"),a.Qb(2,"tr"),a.Qb(3,"th"),a.Fc(4,"Hotel"),a.Pb(),a.Qb(5,"th"),a.Fc(6,"Date"),a.Pb(),a.Qb(7,"th"),a.Fc(8,"Room No."),a.Pb(),a.Qb(9,"th",38),a.Fc(10,"Per night"),a.Pb(),a.Qb(11,"th",38),a.Fc(12,"Vat & Service"),a.Pb(),a.Qb(13,"th",38),a.Fc(14,"Discount"),a.Pb(),a.Qb(15,"th",38),a.Fc(16,"Payable"),a.Pb(),a.Qb(17,"th",38),a.Fc(18,"Advance"),a.Pb(),a.Qb(19,"th",38),a.Fc(20,"Due"),a.Pb(),a.Dc(21,$,2,0,"th",39),a.Mb(22,"th"),a.Pb(),a.Pb(),a.Qb(23,"tbody"),a.Dc(24,V,24,14,"tr",40),a.Pb(),a.Qb(25,"tfoot"),a.Qb(26,"tr"),a.Qb(27,"th",41),a.Fc(28,"Vat and Service Charge"),a.Pb(),a.Qb(29,"th",38),a.Fc(30),a.Pb(),a.Mb(31,"td"),a.Dc(32,Y,1,0,"td",42),a.Pb(),a.Qb(33,"tr"),a.Qb(34,"th",41),a.Fc(35,"Total"),a.Pb(),a.Qb(36,"th",38),a.Fc(37),a.Pb(),a.Mb(38,"td"),a.Dc(39,J,1,0,"td",42),a.Pb(),a.Qb(40,"tr"),a.Qb(41,"th",41),a.Fc(42,"Total Advance"),a.Pb(),a.Qb(43,"th",38),a.Fc(44),a.Pb(),a.Mb(45,"td"),a.Dc(46,U,1,0,"td",42),a.Pb(),a.Qb(47,"tr"),a.Qb(48,"th",41),a.Fc(49,"Total due"),a.Pb(),a.Qb(50,"th",38),a.Fc(51),a.Pb(),a.Mb(52,"td"),a.Dc(53,K,1,0,"td",42),a.Pb(),a.Pb(),a.Pb()),2&t){var n=a.dc(3);a.zb(21),a.lc("ngIf",(null==n.refBy?null:n.refBy.length)>0),a.zb(3),a.lc("ngForOf",n.subBookings),a.zb(6),a.Hc("",null==n.booking?null:n.booking.totalVatService," BDT"),a.zb(2),a.lc("ngIf",(null==n.refBy?null:n.refBy.length)>0),a.zb(5),a.Hc("",null==n.booking?null:n.booking.total," BDT"),a.zb(2),a.lc("ngIf",(null==n.refBy?null:n.refBy.length)>0),a.zb(5),a.Hc("",null==n.booking?null:n.booking.totalAdvance," BDT"),a.zb(2),a.lc("ngIf",(null==n.refBy?null:n.refBy.length)>0),a.zb(5),a.Hc("",null==n.booking?null:n.booking.totalDue," BDT"),a.zb(2),a.lc("ngIf",(null==n.refBy?null:n.refBy.length)>0)}}function W(t,o){if(1&t){var n=a.Rb();a.Qb(0,"admin-user-form",48),a.bc("user",function(t){return a.wc(n),a.dc(3).onCreateUser(t)}),a.Pb()}}var Z=function(t,o){return{"btn-primary active":t,"btn-light":o}};function tt(t,o){if(1&t){var n=a.Rb();a.Qb(0,"div",16),a.Qb(1,"div",17),a.Qb(2,"label",18),a.Qb(3,"input",19),a.bc("ngModelChange",function(t){return a.wc(n),a.dc(2).mode=t}),a.Pb(),a.Fc(4," Sell "),a.Pb(),a.Qb(5,"label",20),a.Qb(6,"input",21),a.bc("ngModelChange",function(t){return a.wc(n),a.dc(2).mode=t}),a.Pb(),a.Fc(7," Reserve "),a.Pb(),a.Pb(),a.Qb(8,"h3",22),a.Fc(9,"New Booking"),a.Pb(),a.Qb(10,"div",23),a.Mb(11,"div",24),a.Qb(12,"div",25),a.Qb(13,"div",26),a.Qb(14,"input",27),a.bc("ngModelChange",function(t){return a.wc(n),a.dc(2).changeSimilar=t}),a.Pb(),a.Qb(15,"label",28),a.Fc(16," Auto Change Similar Category "),a.Pb(),a.Pb(),a.Pb(),a.Qb(17,"div",25),a.Qb(18,"div",29),a.Qb(19,"div",30),a.Qb(20,"div",31),a.Fc(21,"Ref. By"),a.Pb(),a.Pb(),a.Qb(22,"input",32),a.bc("ngModelChange",function(t){return a.wc(n),a.dc(2).refBy=t}),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Qb(23,"div",33),a.Qb(24,"div",34),a.Qb(25,"h5"),a.Fc(26,"Booking List"),a.Pb(),a.Pb(),a.Pb(),a.Dc(27,X,54,10,"table",35),a.Dc(28,W,1,0,"admin-user-form",36),a.Pb()}if(2&t){var e=a.dc(2);a.zb(2),a.lc("ngClass",a.qc(9,Z,"Sell"==e.mode,"Sell"!=e.mode)),a.zb(1),a.lc("ngModel",e.mode),a.zb(2),a.lc("ngClass",a.qc(12,Z,"Reserve"==e.mode,"Reserve"!=e.mode)),a.zb(1),a.lc("ngModel",e.mode),a.zb(8),a.lc("ngModel",e.changeSimilar),a.zb(8),a.lc("ngModel",e.refBy),a.zb(5),a.lc("ngIf",!e.sendingInfo)("ngIfElse",e.sending),a.zb(1),a.lc("ngIf",!e.sendingInfo)}}function ot(t,o){if(1&t&&(a.Qb(0,"div",9),a.Qb(1,"div",10),a.Dc(2,G,1,0,"admin-hotel-list",11),a.Dc(3,q,1,3,"admin-available-room-list",12),a.Pb(),a.Dc(4,tt,29,15,"div",13),a.Pb()),2&t){var n=a.dc();a.zb(2),a.lc("ngIf",!n.showRoomList),a.zb(1),a.lc("ngIf",n.showRoomList),a.zb(1),a.lc("ngIf",n.subBookings.length>0)}}function nt(t,o){if(1&t&&a.Mb(0,"booking-info",56),2&t){var n=a.dc(3);a.lc("booking",n.reservation)}}function et(t,o){if(1&t){var n=a.Rb();a.Qb(0,"div",57),a.Qb(1,"a",58),a.Mb(2,"i",59),a.Fc(3," Print"),a.Pb(),a.Qb(4,"button",60),a.bc("click",function(){a.wc(n);var t=a.dc(3);return t.onCancelBooking(t.reservation.id)}),a.Fc(5," Cancel Booking "),a.Pb(),a.Pb()}if(2&t){var e=a.dc(3);a.zb(1),a.nc("routerLink","/dashboard/printTicket/",e.reservation.id,"")}}function it(t,o){if(1&t){var n=a.Rb();a.Qb(0,"booking-form",61),a.bc("onBooking",function(t){return a.wc(n),a.dc(3).onConfirmRerservation(t)})("cancelBooking",function(t){return a.wc(n),a.dc(3).onCancelRerservation(t)}),a.Pb()}if(2&t){var e=a.dc(3);a.lc("booking",e.reservation)}}var rt=function(t,o){return{"bg-danger":t,"bg-primary":o}};function ct(t,o){if(1&t&&(a.Qb(0,"div",16),a.Qb(1,"div",52),a.Fc(2),a.Pb(),a.Dc(3,nt,1,1,"booking-info",53),a.Dc(4,et,6,1,"div",54),a.Dc(5,it,1,1,"booking-form",55),a.Pb()),2&t){var n=a.dc(2);a.zb(1),a.lc("ngClass",a.qc(5,rt,"ROOM_SOLD"==(null==n.reservation?null:n.reservation.bookingStatus),"ROOM_RESERVED"==(null==n.reservation?null:n.reservation.bookingStatus))),a.zb(1),a.Hc(" ","ROOM_SOLD"==(null==n.reservation?null:n.reservation.bookingStatus)?"Booking Details":"Reservation Details"," "),a.zb(1),a.lc("ngIf","ROOM_SOLD"==(null==n.reservation?null:n.reservation.bookingStatus)),a.zb(1),a.lc("ngIf","ROOM_SOLD"==(null==n.reservation?null:n.reservation.bookingStatus)),a.zb(1),a.lc("ngIf","ROOM_RESERVED"==(null==n.reservation?null:n.reservation.bookingStatus))}}function lt(t,o){if(1&t){var n=a.Rb();a.Qb(0,"div",49),a.Qb(1,"div",50),a.Qb(2,"admin-room-status-date",51),a.bc("roomSelected",function(t){return a.wc(n),a.dc().onRoomSelectFromRoomStatus(t)}),a.Pb(),a.Pb(),a.Dc(3,ct,6,8,"div",13),a.Pb()}if(2&t){var e=a.dc();a.zb(3),a.lc("ngIf",e.reservation)}}var at=function(){function t(t,o,n,e){this.utilService=t,this.userService=o,this.bookingService=n,this.router=e,this.subBookings=[],this.reloadRoomList=!1,this.showRoomList=!1,this.sendingInfo=!1,this.changeSimilar=!0,this.message="",this.active=1,this.mode="Sell"}return t.prototype.ngOnInit=function(){this.booking={total:0,totalAdvance:0,totalDue:0}},t.prototype.onHotel=function(t){this.hotel=t,this.hotelId=t.id,this.showRoomList=!0},t.prototype.onShowHotels=function(t){this.showRoomList=!t,localStorage.removeItem("hotelId")},t.prototype.onRoomSelect=function(t){var o=this;this.utilService.getDatesBetween(t.checkInDate,t.checkOutDate).forEach(function(n){var e=new i.a(n,t.room);e.room.discount>0&&(e.discount=e.room.discount),o.isContain(e)||(o.subBookings.push(e),o.updateSubBooking(o.subBookings.length-1),o.subBookings.sort(o.utilService.dynamicSortObject("date")),o.subBookings.sort(o.utilService.dynamicSortObject("room.roomNumber")))})},t.prototype.onCreateUser=function(t){var o=E({id:0},t);this.createBooking(o)},t.prototype.createBooking=function(t){var o=this,n=new r.a(t,this.subBookings),e=E({total:this.booking.total,totalAdvance:this.booking.totalAdvance,totalDue:this.booking.totalDue},n);switch(this.message="generating booking",this.sendingInfo=!0,this.mode){case"Sell":this.bookingService.createAdminBooking(e).subscribe(function(t){o.message="Booking generated, Thank you.",o.sendingInfo=!1,o.booking.subBookingList=[],o.subBookings=[],o.ngOnInit(),o.reloadRoomList=!o.reloadRoomList,o.router.navigate(["/dashboard/printTicket",t.id])});break;case"Reserve":this.bookingService.reserveAdminBooking(e).subscribe(function(t){o.message="Booking complete, Thank you.",o.sendingInfo=!1,o.reloadRoomList=!o.reloadRoomList,o.ngOnInit(),o.router.navigate(["/dashboard/printTicket",t.id])})}},t.prototype.onReload=function(){this.reloadRoomList=!this.reloadRoomList},t.prototype.isContain=function(t){return this.subBookings.find(function(o){return o.room.id===t.room.id&&o.date===t.date&&o.room.category.hotel.id===t.room.category.hotel.id})},t.prototype.onRemove=function(t){this.unSelect=this.subBookings[t].room.id,this.subBookings.splice(t,1),this.updateBooking(t)},t.prototype.updateSubBooking=function(t){var o=this.subBookings[t];o.payablePrice=Math.round((o.room.price-o.discount)*(1+o.room.vatService/100)),o.due=o.payablePrice-o.advance,this.updateBooking(t)},t.prototype.updateBooking=function(t){var o=0,n=0,e=0,i=0;if(this.changeSimilar){var r=this.subBookings[t];this.subBookings.forEach(function(t){t.room.category.id==r.room.category.id&&(t.discount=r.discount,t.advance=r.advance,t.payablePrice=Math.round((t.room.price-t.discount)*(1+t.room.vatService/100)),t.due=t.payablePrice-t.advance)})}this.subBookings.forEach(function(t){o+=t.payablePrice,n+=t.advance,e+=t.due,i+=t.room.vatService/100*(t.room.price-t.discount)}),this.booking.totalVatService=i,this.booking.total=o,this.booking.totalAdvance=n,this.booking.totalDue=e},t.prototype.onRoomSelectFromRoomStatus=function(t){return N(this,void 0,void 0,function(){var o=this;return T(this,function(n){switch(n.label){case 0:return[4,this.bookingService.getAdminBooking(t.bookingId).subscribe(function(t){o.reservation=t})];case 1:return n.sent(),[2]}})})},t.prototype.onConfirmRerservation=function(t){return N(this,void 0,void 0,function(){var o=this;return T(this,function(n){switch(n.label){case 0:return confirm("Are you sure to confirm reservation with id : "+t.id)?[4,this.bookingService.confirmAdminReservation(t).subscribe(function(t){o.reservation=null,console.log(t),console.log("Confirm Reservation Done")})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.onCancelRerservation=function(t){return N(this,void 0,void 0,function(){var o=this;return T(this,function(n){switch(n.label){case 0:return console.log("onCancelRerservation ",t),confirm("Are you sure to cancel reservation with id : "+t)?[4,this.bookingService.cancelAdminReservation(t).subscribe(function(t){o.reservation=null,console.log("Cancel Reservation done")})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.onCancelBooking=function(t){return N(this,void 0,void 0,function(){var o=this;return T(this,function(n){return confirm("Are you sure to cancel booking with id : "+t)&&(console.log("cancel booking : ",t),this.bookingService.cancelAdminBooking(t).subscribe(function(t){console.log(t),console.log("Booking canceled"),o.reservation=null})),[2]})})},t.prototype.getMySells=function(){return N(this,void 0,void 0,function(){return T(this,function(t){return[2]})})},t.\u0275fac=function(o){return new(o||t)(a.Lb(e.a),a.Lb(c.a),a.Lb(l.a),a.Lb(b.b))},t.\u0275cmp=a.Fb({type:t,selectors:[["app-admin-sell-room"]],decls:15,vars:4,consts:[[1,"container-fluid","d-print-none"],[1,"row","px-3","details-title","text-left"],[1,"container-fluid"],["ngbNav","",1,"nav-tabs",3,"activeId","activeIdChange"],["nav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2",3,"ngbNavOutlet"],[1,"row","m-0","py-2"],[1,"col-md-4","p-0"],[3,"hotel",4,"ngIf"],[3,"hotel","unSelect","reloadRoomList","showHotels","roomSelected",4,"ngIf"],["class","col-md-8",4,"ngIf"],[3,"hotel"],[3,"hotel","unSelect","reloadRoomList","showHotels","roomSelected"],[1,"col-md-8"],["data-toggle","buttons",1,"btn-group","btn-group-toggle","border"],[1,"btn",3,"ngClass"],["type","radio","value","Sell","name","mode","id","mode_sell","autocomplete","off",3,"ngModel","ngModelChange"],[1,"btn","btn-primary",3,"ngClass"],["type","radio","value","Reserve","name","mode","id","mode_reservation","autocomplete","off",3,"ngModel","ngModelChange"],[1,"text-center"],[1,"row"],[1,"col-md-6"],[1,"col-md-3"],[1,"form-check","mb-2"],["type","checkbox","id","changeSimilar",1,"form-check-input",3,"ngModel","ngModelChange"],["for","changeSimilar",1,"form-check-label"],[1,"input-group","mb-2"],[1,"input-group-prepend"],[1,"input-group-text"],["type","text","id","refBy",1,"form-control",3,"ngModel","ngModelChange"],[1,"row","m-0"],[1,"col-12","bg-primary","text-white","text-center"],["class","table mb-4 border table-responsive-sm",4,"ngIf","ngIfElse"],[3,"user",4,"ngIf"],[1,"table","mb-4","border","table-responsive-sm"],[1,"text-right"],["class","text-right",4,"ngIf"],[4,"ngFor","ngForOf"],["colspan","8",1,"text-right"],[4,"ngIf"],["type","number","name","totalDiscount",1,"form-control","float-right","text-right",3,"ngModel","ngModelChange","keyup"],["type","number","name","advance",1,"form-control","float-right","text-right",3,"ngModel","ngModelChange","keyup"],[1,"btn-sm","btn-danger",3,"click"],[1,"fa","fa-trash-o"],["type","number","name","commission",1,"form-control","float-right","text-right",3,"ngModel","ngModelChange"],[3,"user"],[1,"mt-2","row"],[1,"col-md-4"],[3,"roomSelected"],[1,"p-3","mb-2","text-white",3,"ngClass"],[3,"booking",4,"ngIf"],["class","d-flex flex-row-reverse bd-highlight mb-4",4,"ngIf"],[3,"booking","onBooking","cancelBooking",4,"ngIf"],[3,"booking"],[1,"d-flex","flex-row-reverse","bd-highlight","mb-4"],[1,"btn","btn-sm","btn-primary","mx-1",3,"routerLink"],[1,"fa","fa-print"],[1,"btn","btn-sm","btn-danger",3,"click"],[3,"booking","onBooking","cancelBooking"]],template:function(t,o){if(1&t&&(a.Qb(0,"div",0),a.Qb(1,"span",1),a.Fc(2,"Sell room"),a.Pb(),a.Pb(),a.Qb(3,"div",2),a.Qb(4,"ul",3,4),a.bc("activeIdChange",function(t){return o.active=t}),a.Qb(6,"li",5),a.Qb(7,"a",6),a.Fc(8,"Sell room"),a.Pb(),a.Dc(9,ot,5,3,"ng-template",7),a.Pb(),a.Qb(10,"li",5),a.Qb(11,"a",6),a.Fc(12,"Room status"),a.Pb(),a.Dc(13,lt,4,1,"ng-template",7),a.Pb(),a.Pb(),a.Mb(14,"div",8),a.Pb()),2&t){var n=a.vc(5);a.zb(4),a.lc("activeId",o.active),a.zb(2),a.lc("ngbNavItem",1),a.zb(4),a.lc("ngbNavItem",2),a.zb(4),a.lc("ngbNavOutlet",n)}},directives:[s.i,s.k,s.l,s.j,s.m,u.q,d.a,Q,u.o,w.s,w.b,w.m,w.p,w.a,u.p,w.r,M,A,H.a,b.d,_.a],pipes:[u.g],styles:[".table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.15rem}.form-control[_ngcontent-%COMP%]{max-width:90px;padding:.15rem .5rem;height:calc(1.75rem + 2px)}"]}),t}(),bt=n("3whx"),st=function(){return(st=Object.assign||function(t){for(var o,n=1,e=arguments.length;n<e;n++)for(var i in o=arguments[n])Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);return t}).apply(this,arguments)};function ut(t,o){if(1&t){var n=a.Rb();a.Qb(0,"a",10),a.bc("click",function(){a.wc(n);var t=o.$implicit;return a.dc(2).onSelectBooking(t.id)}),a.Fc(1),a.ec(2,"date"),a.Pb()}if(2&t){var e=o.$implicit;a.zb(1),a.Jc(" [",e.id,"] ",e.user.name," - ",a.gc(2,3,e.created,"MMM d, y, h:mm:ss a")," ")}}function dt(t,o){if(1&t&&(a.Qb(0,"ul",7),a.Qb(1,"li",8),a.Qb(2,"h5"),a.Fc(3,"Booking List"),a.Pb(),a.Qb(4,"small"),a.Fc(5,"Choose a booking from below list"),a.Pb(),a.Pb(),a.Dc(6,ut,3,6,"a",9),a.Pb()),2&t){var n=a.dc();a.zb(6),a.lc("ngForOf",n.offlineBookings)}}function gt(t,o){1&t&&a.Mb(0,"loading")}function ft(t,o){if(1&t){var n=a.Rb();a.Qb(0,"tr"),a.Qb(1,"td"),a.Fc(2),a.Pb(),a.Qb(3,"td"),a.Fc(4),a.ec(5,"date"),a.Pb(),a.Qb(6,"td"),a.Fc(7),a.Pb(),a.Qb(8,"td",15),a.Fc(9),a.Pb(),a.Qb(10,"td",15),a.Fc(11),a.Pb(),a.Qb(12,"td",15),a.Fc(13),a.Pb(),a.Qb(14,"td"),a.Qb(15,"button",19),a.bc("click",function(){a.wc(n);var t=o.index;return a.dc(3).removeRoom(t)}),a.Mb(16,"i",20),a.Pb(),a.Pb(),a.Pb()}if(2&t){var e=o.$implicit;a.zb(2),a.Gc(null==e||null==e.room.category||null==e.room.category.hotel?null:e.room.category.hotel.name),a.zb(2),a.Gc(a.gc(5,7,null==e?null:e.date,"d MMM,yy")),a.zb(3),a.Ic(" ",null==e||null==e.room?null:e.room.roomNumber," [",null==e||null==e.room.category?null:e.room.category.name,"] "),a.zb(2),a.Hc("",null==e||null==e.room?null:e.room.price," BDT"),a.zb(2),a.Hc("",null==e?null:e.discount," BDT"),a.zb(2),a.Hc("",null==e?null:e.payablePrice," BDT")}}function ht(t,o){if(1&t&&(a.Qb(0,"tbody"),a.Dc(1,ft,17,10,"tr",18),a.Pb()),2&t){var n=a.dc(2);a.zb(1),a.lc("ngForOf",n.booking.subBookingList)}}function mt(t,o){if(1&t){var n=a.Rb();a.Qb(0,"button",25),a.bc("click",function(){a.wc(n);var t=a.dc(3);return t.onConfirmBooking(t.booking.id)}),a.Mb(1,"i",26),a.Fc(2," Confirm booking "),a.Pb()}}function pt(t,o){if(1&t){var n=a.Rb();a.Qb(0,"button",27),a.bc("click",function(){a.wc(n);var t=a.dc(3);return t.onDeleteBooking(t.booking.id)}),a.Mb(1,"i",28),a.Fc(2," Delete booking "),a.Pb()}}function vt(t,o){1&t&&a.Mb(0,"loading")}function kt(t,o){if(1&t&&(a.Qb(0,"div",21),a.Dc(1,mt,3,0,"button",22),a.Dc(2,pt,3,0,"button",23),a.Dc(3,vt,1,0,"ng-template",null,24,a.Ec),a.Pb()),2&t){var n=a.vc(4),e=a.dc(2);a.zb(1),a.lc("ngIf",!e.loading)("ngIfElse",n),a.zb(1),a.lc("ngIf",!e.loading)}}function yt(t,o){if(1&t&&(a.Qb(0,"div",11),a.Qb(1,"div",2),a.Qb(2,"div",12),a.Qb(3,"h3"),a.Fc(4,"Customer Info"),a.Pb(),a.Qb(5,"table"),a.Qb(6,"tr"),a.Qb(7,"th"),a.Fc(8,"Name :"),a.Pb(),a.Qb(9,"th"),a.Fc(10),a.Pb(),a.Pb(),a.Qb(11,"tr"),a.Qb(12,"th"),a.Fc(13,"Phone :"),a.Pb(),a.Qb(14,"th"),a.Fc(15),a.Pb(),a.Pb(),a.Qb(16,"tr"),a.Qb(17,"th"),a.Fc(18,"Email :"),a.Pb(),a.Qb(19,"th"),a.Fc(20),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Mb(21,"div",13),a.Qb(22,"div",12),a.Qb(23,"h3"),a.Fc(24,"Hotel Info"),a.Pb(),a.Qb(25,"table"),a.Qb(26,"tr"),a.Qb(27,"th"),a.Fc(28,"Name :"),a.Pb(),a.Qb(29,"td"),a.Fc(30),a.Pb(),a.Pb(),a.Qb(31,"tr"),a.Qb(32,"th"),a.Fc(33,"Phone :"),a.Pb(),a.Qb(34,"td"),a.Fc(35),a.Pb(),a.Pb(),a.Qb(36,"tr"),a.Qb(37,"th"),a.Fc(38,"Address:"),a.Pb(),a.Qb(39,"td"),a.Fc(40),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Qb(41,"div",2),a.Qb(42,"table",14),a.Qb(43,"thead"),a.Qb(44,"tr"),a.Qb(45,"th"),a.Fc(46,"Hotel"),a.Pb(),a.Qb(47,"th"),a.Fc(48,"Date"),a.Pb(),a.Qb(49,"th"),a.Fc(50,"Room number"),a.Pb(),a.Qb(51,"th",15),a.Fc(52,"Per night"),a.Pb(),a.Qb(53,"th",15),a.Fc(54,"Discount"),a.Pb(),a.Qb(55,"th",15),a.Fc(56,"Payable"),a.Pb(),a.Mb(57,"th",15),a.Pb(),a.Pb(),a.Dc(58,ht,2,1,"tbody",5),a.Qb(59,"tfoot"),a.Qb(60,"tr"),a.Qb(61,"th",16),a.Fc(62,"Sub total"),a.Pb(),a.Qb(63,"th",15),a.Fc(64),a.Pb(),a.Mb(65,"td"),a.Pb(),a.Qb(66,"tr"),a.Qb(67,"th",16),a.Fc(68,"Discount"),a.Pb(),a.Qb(69,"th",15),a.Fc(70),a.Pb(),a.Mb(71,"td"),a.Pb(),a.Qb(72,"tr"),a.Qb(73,"th",16),a.Fc(74,"Promotional Discount"),a.Pb(),a.Qb(75,"th",15),a.Fc(76),a.Pb(),a.Mb(77,"td"),a.Pb(),a.Qb(78,"tr"),a.Qb(79,"th",16),a.Fc(80,"Total"),a.Pb(),a.Qb(81,"th",15),a.Fc(82),a.Pb(),a.Mb(83,"td"),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Dc(84,kt,5,3,"div",17),a.Pb()),2&t){var n=a.dc();a.zb(10),a.Gc(null==n.booking||null==n.booking.user?null:n.booking.user.name),a.zb(5),a.Gc(null==n.booking||null==n.booking.user?null:n.booking.user.phoneNumber),a.zb(5),a.Gc(null==n.booking||null==n.booking.user?null:n.booking.user.email),a.zb(10),a.Gc(null==n.booking?null:n.booking.hotels[0].name),a.zb(5),a.Gc(null==n.booking?null:n.booking.hotels[0].phoneNumber),a.zb(5),a.Gc(null==n.booking?null:n.booking.hotels[0].address.commaSeperatedString),a.zb(18),a.lc("ngIf",null!=n.booking&&null!=n.booking.subBookingList&&n.booking.subBookingList.length>0),a.zb(6),a.Hc("",null==n.booking?null:n.booking.subtotal," BDT"),a.zb(6),a.Hc("",null==n.booking?null:n.booking.totalDiscount," BDT"),a.zb(6),a.Hc("",null==n.booking?null:n.booking.promotionDiscount," BDT"),a.zb(6),a.Hc("",null==n.booking?null:n.booking.total," BDT"),a.zb(2),a.lc("ngIf",null!=(null==n.booking?null:n.booking.subBookingList)&&n.booking.subBookingList.length>0)}}var Pt=function(){function t(t){this.bookingService=t,this.loading=!1}return t.prototype.ngOnInit=function(){this.getOfflineBookings()},t.prototype.onSelectBooking=function(t){var o=this.offlineBookings.find(function(o){return o.id===t});this.booking=st({},o)},t.prototype.getOfflineBookings=function(){return t=this,void 0,n=function(){var t=this;return function(t,o){var n,e,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,e&&(i=2&r[0]?e.return:r[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,r[1])).done)return i;switch(e=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,e=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=o.call(t,c)}catch(l){r=[6,l],e=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}}(this,function(o){switch(o.label){case 0:return this.loading=!0,[4,this.bookingService.getOfflineBookings().subscribe(function(o){t.offlineBookings=o,t.loading=!1})];case 1:return o.sent(),[2]}})},new((o=void 0)||(o=Promise))(function(e,i){function r(t){try{l(n.next(t))}catch(o){i(o)}}function c(t){try{l(n.throw(t))}catch(o){i(o)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o(function(t){t(n)})).then(r,c)}l((n=n.apply(t,[])).next())});var t,o,n},t.prototype.onConfirmBooking=function(t){var o=this;console.log("CON",t),this.loading=!0,this.bookingService.confirmOfflineBookings(t).subscribe(function(t){console.log(t),o.booking=null,o.loading=!1,o.getOfflineBookings()})},t.prototype.onDeleteBooking=function(t){var o=this;this.loading=!0,this.bookingService.deleteOfflineBookings(t).subscribe(function(t){o.booking=null,o.loading=!1,o.getOfflineBookings()})},t.\u0275fac=function(o){return new(o||t)(a.Lb(l.a))},t.\u0275cmp=a.Fb({type:t,selectors:[["app-offline-bookings"]],decls:9,vars:3,consts:[[1,"container-fluid"],[1,"row","px-3","details-title","text-left"],[1,"row"],[1,"col-md-3"],["class","list-group",4,"ngIf"],[4,"ngIf"],["class","col-md-9",4,"ngIf"],[1,"list-group"],[1,"list-group-item"],["class","list-group-item list-group-item-action",3,"click",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action",3,"click"],[1,"col-md-9"],[1,"col-md-4","border","my-4","p-2"],[1,"col-md-4","my-4","p-2"],[1,"table","table-responsive-sm","border"],[1,"text-right"],["colspan","5",1,"text-right"],["class","d-flex flex-row-reverse bd-highlight mb-5",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fa","fa-trash-o"],[1,"d-flex","flex-row-reverse","bd-highlight","mb-5"],["class","btn btn-sm btn-success mx-2",3,"click",4,"ngIf","ngIfElse"],["class","btn btn-sm btn-danger mx-2",3,"click",4,"ngIf"],["loadMessage",""],[1,"btn","btn-sm","btn-success","mx-2",3,"click"],[1,"fa","fa-check"],[1,"btn","btn-sm","btn-danger","mx-2",3,"click"],[1,"fa","fa-trash"]],template:function(t,o){1&t&&(a.Qb(0,"div",0),a.Qb(1,"span",1),a.Fc(2,"Offline bookings"),a.Pb(),a.Pb(),a.Qb(3,"div",0),a.Qb(4,"div",2),a.Qb(5,"div",3),a.Dc(6,dt,7,1,"ul",4),a.Dc(7,gt,1,0,"loading",5),a.Pb(),a.Dc(8,yt,85,12,"div",6),a.Pb(),a.Pb()),2&t&&(a.zb(6),a.lc("ngIf",!o.loading),a.zb(1),a.lc("ngIf",o.loading),a.zb(1),a.lc("ngIf",o.booking))},directives:[u.q,u.p,h.a],pipes:[u.f],styles:[".list-group-item[_ngcontent-%COMP%]{cursor:pointer;padding:.15rem 1.25rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.15rem}"]}),t}(),Qt=n("YBP9"),wt=function(t,o,n,e){return new(n||(n=Promise))(function(i,r){function c(t){try{a(e.next(t))}catch(o){r(o)}}function l(t){try{a(e.throw(t))}catch(o){r(o)}}function a(t){var o;t.done?i(t.value):(o=t.value,o instanceof n?o:new n(function(t){t(o)})).then(c,l)}a((e=e.apply(t,o||[])).next())})},Dt=function(t,o){var n,e,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,e&&(i=2&r[0]?e.return:r[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,r[1])).done)return i;switch(e=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,e=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=o.call(t,c)}catch(l){r=[6,l],e=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}};function St(t,o){if(1&t){var n=a.Rb();a.Qb(0,"div",9),a.Qb(1,"button",10),a.bc("click",function(){a.wc(n);var t=a.dc(2);return t.onCancelBooking(t.booking.id)}),a.Mb(2,"i",11),a.Fc(3," Cancel booking "),a.Pb(),a.Pb()}}function Ft(t,o){if(1&t&&(a.Qb(0,"div",6),a.Mb(1,"admin-booking-details",7),a.Dc(2,St,4,0,"div",8),a.Pb()),2&t){var n=a.dc();a.zb(1),a.lc("booking",n.booking),a.zb(1),a.lc("ngIf",null!=(null==n.booking?null:n.booking.subBookingList)&&n.booking.subBookingList.length>0)}}var Mt=[{path:"sell-rooms",component:at},{path:"offline-bookings",component:Pt},{path:"cancel-bookings",component:function(){function t(t,o){this.utilService=t,this.bookingService=o,this.showRoomList=!1,this.reload=!1}return t.prototype.ngOnInit=function(){},t.prototype.onHotel=function(t){this.hotelId=t.id,this.showRoomList=!0},t.prototype.onShowHotels=function(t){this.showRoomList=!t},t.prototype.onRoomSelect=function(t){this.getAdminBooking(t.bookingId)},t.prototype.getAdminBooking=function(t){return wt(this,void 0,void 0,function(){var o=this;return Dt(this,function(n){switch(n.label){case 0:return null!=this.booking&&this.booking.id==t?[3,2]:[4,this.bookingService.getAdminBooking(t).subscribe(function(t){o.booking=t})];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.prototype.onCancelBooking=function(t){return wt(this,void 0,void 0,function(){var o=this;return Dt(this,function(n){switch(n.label){case 0:return confirm("Are you sure to cancel booking with booking id "+t)?[4,this.bookingService.cancelAdminBooking(t).subscribe(function(t){console.log(t),o.booking=null,o.reload=!o.reload})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},t.\u0275fac=function(o){return new(o||t)(a.Lb(e.a),a.Lb(l.a))},t.\u0275cmp=a.Fb({type:t,selectors:[["app-cancel-bookings"]],decls:8,vars:2,consts:[[1,"container-fluid"],[1,"row","px-3","details-title","text-left"],[1,"row","m-0"],[1,"col-md-4","mb-5"],[3,"reload","roomSelected"],["class","col-md-8",4,"ngIf"],[1,"col-md-8"],[3,"booking"],["class","d-flex flex-row-reverse bd-highlight mb-5",4,"ngIf"],[1,"d-flex","flex-row-reverse","bd-highlight","mb-5"],[1,"btn","btn-sm","btn-success","mx-2",3,"click"],[1,"fa","fa-check"]],template:function(t,o){1&t&&(a.Qb(0,"div",0),a.Qb(1,"span",1),a.Fc(2,"Cancel Bookings"),a.Pb(),a.Pb(),a.Qb(3,"div",0),a.Qb(4,"div",2),a.Qb(5,"div",3),a.Qb(6,"admin-room-status-date",4),a.bc("roomSelected",function(t){return o.onRoomSelect(t)}),a.Pb(),a.Pb(),a.Dc(7,Ft,3,2,"div",5),a.Pb(),a.Pb()),2&t&&(a.zb(6),a.lc("reload",o.reload),a.zb(1),a.lc("ngIf",o.booking))},directives:[A,u.q,Qt.a],styles:[""]}),t}()}],Rt=function(){function t(){}return t.\u0275mod=a.Jb({type:t}),t.\u0275inj=a.Ib({factory:function(o){return new(o||t)},imports:[[bt.a,b.e.forChild(Mt)]]}),t}()}}]);