(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{IxGd:function(e,t,n){"use strict";n.r(t),n.d(t,"ROUTES",function(){return Pe}),n.d(t,"UsersModule",function(){return ve});var r=n("iInd"),o=n("KZX/"),i=n("8Y7J"),c=function(){function e(){}return e.prototype.ngOnInit=function(){},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Fb({type:e,selectors:[["app-add"]],decls:2,vars:0,template:function(e,t){1&e&&(i.Qb(0,"p"),i.Fc(1," add works!\n"),i.Pb())},styles:[""]}),e}(),s=n("ITiG"),u=n("s7LF"),a=function(e){return e.ROLE_ADMIN="Admin",e.ROLE_AGENT="Agent",e.ROLE_SERVICE_ADMIN="Service Admin",e.ROLE_SERVICE_AGENT="Service Agent",e.ROLE_USER="User",e}({}),l=n("SVse"),b=n("uEz7");function f(e,t){if(1&e){var n=i.Rb();i.Qb(0,"div",16),i.Qb(1,"a",17),i.bc("click",function(){return i.wc(n),i.dc().onAddUser()}),i.Mb(2,"i",18),i.Fc(3," Add user"),i.Pb(),i.Pb()}}function d(e,t){if(1&e&&(i.Qb(0,"span",24),i.Fc(1),i.Pb()),2&e){var n=t.$implicit,r=t.index,o=i.dc().$implicit;i.zb(1),i.Ic(" ",n.name," ",r+1==(null==o?null:o.roles.length)?"":","," ")}}function h(e,t){if(1&e){var n=i.Rb();i.Qb(0,"button",21),i.bc("click",function(){i.wc(n);var e=i.dc().$implicit;return i.dc().onActivate(e.id)}),i.Mb(1,"i",25),i.Pb()}}function p(e,t){if(1&e){var n=i.Rb();i.Qb(0,"tr"),i.Qb(1,"td"),i.Fc(2),i.Mb(3,"br"),i.Dc(4,d,2,2,"span",19),i.Pb(),i.Qb(5,"td"),i.Fc(6),i.Mb(7,"br"),i.Fc(8),i.Pb(),i.Qb(9,"td"),i.Fc(10),i.Pb(),i.Qb(11,"td"),i.Qb(12,"div",20),i.Qb(13,"button",21),i.bc("click",function(){i.wc(n);var e=t.$implicit;return i.dc().onEdit(e.id)}),i.Mb(14,"i",22),i.Pb(),i.Dc(15,h,2,0,"button",23),i.Pb(),i.Pb(),i.Pb()}if(2&e){var r=t.$implicit,o=i.dc();i.zb(2),i.Hc(" ",r.name," "),i.zb(2),i.lc("ngForOf",null==r?null:r.roles),i.zb(2),i.Hc(" ",r.phoneNumber," "),i.zb(2),i.Hc(" ",r.email," "),i.zb(2),i.Gc(r.enabled?"ACTIVE":"INACTIVE"),i.zb(5),i.lc("ngIf",!o.short)}}function m(e,t){if(1&e){var n=i.Rb();i.Qb(0,"pagination",26),i.bc("getPage",function(e){return i.wc(n),i.dc().getUserPage(e)}),i.Pb()}if(2&e){var r=i.dc();i.lc("page",r.users)("short",r.short)}}var g=function(){function e(){this.edit=new i.n,this.add=new i.n,this.activate=new i.n,this.page=new i.n,this.search=new i.n}return e.prototype.ngOnInit=function(){},e.prototype.submit=function(){this.search.emit(this.userQuery)},e.prototype.getUserPage=function(e){this.page.emit(e)},e.prototype.onEdit=function(e){this.edit.emit(e)},e.prototype.onAddUser=function(){this.add.emit()},e.prototype.onActivate=function(e){this.activate.emit(e)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Fb({type:e,selectors:[["user-list"]],inputs:{users:"users",short:"short"},outputs:{edit:"edit",add:"add",activate:"activate",page:"page",search:"search"},decls:34,vars:4,consts:[[1,"table","table-hover","table-responsive-sm","border"],[2,"background-color","#f8f9fa"],["colspan","4"],[1,"row"],[1,"col"],[1,"mr-auto"],["class","col-auto",4,"ngIf"],[1,"mx-3","my-1",3,"ngSubmit"],[1,"input-group","mb-2"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"fa","fa-search"],["type","text","id","userQuery","name","userQuery","placeholder","User name or phone",1,"form-control",3,"ngModel","ngModelChange"],[1,"pl-3"],[4,"ngFor","ngForOf"],[3,"page","short","getPage",4,"ngIf"],[1,"col-auto"],[2,"cursor","pointer",3,"click"],[1,"fa","fa-plus"],["class","user_role",4,"ngFor","ngForOf"],["role","group","aria-label","Basic example",1,"btn-group"],["type","button",1,"btn","btn-light",3,"click"],[1,"fa","fa-pencil-square-o"],["type","button","class","btn btn-light",3,"click",4,"ngIf"],[1,"user_role"],[1,"fa","fa-power-off"],[3,"page","short","getPage"]],template:function(e,t){1&e&&(i.Qb(0,"table",0),i.Qb(1,"thead"),i.Qb(2,"tr",1),i.Qb(3,"td",2),i.Qb(4,"div",3),i.Qb(5,"div",4),i.Qb(6,"h5",5),i.Fc(7,"List of Users"),i.Pb(),i.Pb(),i.Dc(8,f,4,0,"div",6),i.Pb(),i.Pb(),i.Pb(),i.Qb(9,"tr"),i.Qb(10,"td",2),i.Qb(11,"form",7),i.bc("ngSubmit",function(){return t.submit()}),i.Qb(12,"div",8),i.Qb(13,"div",9),i.Qb(14,"div",10),i.Mb(15,"i",11),i.Fc(16,"\xa0 Search "),i.Pb(),i.Pb(),i.Qb(17,"input",12),i.bc("ngModelChange",function(e){return t.userQuery=e}),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Qb(18,"tr"),i.Qb(19,"th",13),i.Fc(20,"Name"),i.Pb(),i.Qb(21,"th"),i.Fc(22,"Phone "),i.Mb(23,"br"),i.Fc(24,"Email "),i.Pb(),i.Qb(25,"th"),i.Fc(26,"Staus"),i.Pb(),i.Mb(27,"th"),i.Pb(),i.Pb(),i.Qb(28,"tbody"),i.Dc(29,p,16,6,"tr",14),i.Pb(),i.Qb(30,"tfoot"),i.Qb(31,"tr"),i.Qb(32,"td",2),i.Dc(33,m,1,2,"pagination",15),i.Pb(),i.Pb(),i.Pb(),i.Pb()),2&e&&(i.zb(8),i.lc("ngIf",!t.short),i.zb(9),i.lc("ngModel",t.userQuery),i.zb(12),i.lc("ngForOf",null==t.users?null:t.users.content),i.zb(4),i.lc("ngIf",null!=t.users))},directives:[l.q,u.x,u.n,u.o,u.b,u.m,u.p,l.p,b.a],styles:[".btn-web[_ngcontent-%COMP%], .hotel-button[_ngcontent-%COMP%]{color:#fff;background-color:#3f87c7}.hotel-button-reverse[_ngcontent-%COMP%], .hotel-button[_ngcontent-%COMP%]:hover{background-color:#f7a71a}.hotel-button-reverse[_ngcontent-%COMP%]{color:#fff}.hotel-button-reverse[_ngcontent-%COMP%]:hover{background-color:#3f87c7}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.15rem .75rem}.user_role[_ngcontent-%COMP%]{background:#1b2445;color:#fff;padding:0 4px;border-radius:5px;font-family:monospace;font-size:12px}"]}),e}(),P=function(){return(P=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function v(e,t){1&e&&(i.Qb(0,"small",21),i.Fc(1," Name required "),i.Pb())}function Q(e,t){if(1&e&&(i.Qb(0,"small",21),i.Qb(1,"div",22),i.Fc(2," Phone number required "),i.Pb(),i.Qb(3,"div",22),i.Fc(4," Phone number format 01934953023 "),i.Pb(),i.Pb()),2&e){var n=i.dc();i.zb(1),i.lc("hidden",!n.form.controls.phoneNumber.errors.required),i.zb(2),i.lc("hidden",!n.form.controls.phoneNumber.errors.pattern)}}function y(e,t){1&e&&(i.Qb(0,"span"),i.Fc(1,"password required"),i.Pb())}function w(e,t){1&e&&(i.Qb(0,"span"),i.Fc(1,"minimum 6 character required"),i.Pb())}function F(e,t){if(1&e&&(i.Qb(0,"small",23),i.Dc(1,y,2,0,"span",24),i.Dc(2,w,2,0,"span",24),i.Pb()),2&e){var n=i.dc();i.zb(1),i.lc("ngIf",n.form.controls.password.errors.required),i.zb(1),i.lc("ngIf",n.form.controls.password.errors.minlength)}}function x(e,t){if(1&e&&(i.Qb(0,"option",25),i.Fc(1),i.Pb()),2&e){var n=t.$implicit;i.lc("value",n.key),i.zb(1),i.Hc(" ",n.value," ")}}var C=function(e,t,n){return{disabled:e,"btn-warning":t,"btn-success":n}},M=function(){function e(e){this.builder=e,this.create=new i.n,this.update=new i.n,this.close=new i.n,this.roleEnum=a,this.exists=!1,this.createForm()}return e.prototype.ngOnChanges=function(e){e.user&&this.user&&this.user.id&&(this.exists=!0,this.form.patchValue(P({},{name:this.user.name,phoneNumber:this.user.phoneNumber,email:this.user.email,role:this.user.roles[0].role,password:"******"})))},e.prototype.createForm=function(){this.form=this.builder.group({name:["",u.v.required],phoneNumber:["",[u.v.required,u.v.pattern("^01[3-9][ ]?[0-9]{2}[ ]?[0-9]{3}[ ]?[0-9]{3}$")]],password:["",[u.v.required,u.v.minLength(6)]],email:"",role:["ROLE_USER",u.v.required]})},e.prototype.submit=function(){if(this.form.valid){if(this.exists){var e=P({},this.form.value);this.update.emit(P(P({},e),{roles:[{role:e.role}]}))}else e=P({},this.form.value),this.create.emit({id:null,username:null,password:e.password,enabled:null,accountNonExpired:null,accountNonLocked:null,credentialsNonExpired:null,commissionPercent:null,name:e.name,phoneNumber:e.phoneNumber,email:e.email,roles:[{role:e.role}]});this.form.reset(),this.exists=!1}},e.prototype.onClear=function(){this.close.emit(!0)},e.\u0275fac=function(t){return new(t||e)(i.Lb(u.d))},e.\u0275cmp=i.Fb({type:e,selectors:[["user-registration-form"]],inputs:{user:"user"},outputs:{create:"create",update:"update",close:"close"},features:[i.xb],decls:35,vars:15,consts:[[1,"border","rounded"],[1,"p-1","pl-3",2,"background-color","#f8f9fa"],[1,"mr-auto"],[1,"py-1","px-4",3,"formGroup","ngSubmit"],[1,"form-group"],["for","name"],["id","name","placeholder","Name","formControlName","name",1,"form-control"],["class","text-danger",4,"ngIf"],["for","phone"],["placeholder","Phone","id","phone","maxlength","11","formControlName","phoneNumber",1,"form-control",3,"readonly"],["for","email"],["type","email","id","email","placeholder","Email","formControlName","email",1,"form-control"],["for","password"],["type","text","id","password","placeholder","password","formControlName","password",1,"form-control",3,"readonly"],["class","form-text text-danger",4,"ngIf"],["for","role"],["id","role","formControlName","role",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"d-flex","flex-row-reverse","bd-highlight","my-2"],["type","submit",1,"btn","btn-sm","mx-1",3,"ngClass"],["type","button",1,"btn","btn-sm","btn-danger","mx-1",3,"click"],[1,"text-danger"],[3,"hidden"],[1,"form-text","text-danger"],[4,"ngIf"],[3,"value"]],template:function(e,t){1&e&&(i.Qb(0,"div",0),i.Qb(1,"div",1),i.Qb(2,"h5",2),i.Fc(3,"User Form"),i.Pb(),i.Pb(),i.Qb(4,"form",3),i.bc("ngSubmit",function(){return t.submit()}),i.Qb(5,"div",4),i.Qb(6,"label",5),i.Fc(7,"Name *"),i.Pb(),i.Mb(8,"input",6),i.Dc(9,v,2,0,"small",7),i.Pb(),i.Qb(10,"div",4),i.Qb(11,"label",8),i.Fc(12,"Phone *"),i.Pb(),i.Mb(13,"input",9),i.Dc(14,Q,5,2,"small",7),i.Pb(),i.Qb(15,"div",4),i.Qb(16,"label",10),i.Fc(17,"Email"),i.Pb(),i.Mb(18,"input",11),i.Pb(),i.Qb(19,"div",4),i.Qb(20,"label",12),i.Fc(21,"Password"),i.Pb(),i.Mb(22,"input",13),i.Dc(23,F,3,2,"small",14),i.Pb(),i.Qb(24,"div",4),i.Qb(25,"label",15),i.Fc(26,"Role "),i.Pb(),i.Qb(27,"select",16),i.Dc(28,x,2,2,"option",17),i.ec(29,"keyvalue"),i.Pb(),i.Pb(),i.Qb(30,"div",18),i.Qb(31,"button",19),i.Fc(32),i.Pb(),i.Qb(33,"button",20),i.bc("click",function(){return t.onClear()}),i.Fc(34," Close "),i.Pb(),i.Pb(),i.Pb(),i.Pb()),2&e&&(i.zb(4),i.lc("formGroup",t.form),i.zb(5),i.lc("ngIf",t.form.controls.name.errors&&t.form.controls.name.touched),i.zb(4),i.lc("readonly",t.exists),i.zb(1),i.lc("ngIf",t.form.controls.phoneNumber.errors&&t.form.controls.phoneNumber.touched),i.zb(8),i.lc("readonly",t.exists),i.zb(1),i.lc("ngIf",t.form.controls.password.errors&&t.form.controls.password.dirty),i.zb(5),i.lc("ngForOf",i.fc(29,9,t.roleEnum)),i.zb(3),i.lc("ngClass",i.rc(11,C,t.form.invalid,t.exists,!t.exists)),i.zb(1),i.Hc(" ",t.exists?"Update":"Create"," User "))},directives:[u.x,u.n,u.g,u.b,u.m,u.f,l.q,u.j,u.u,l.p,l.o,u.q,u.w],pipes:[l.k],styles:[""]}),e}(),O=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function c(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,s)}u((r=r.apply(e,t||[])).next())})},z=function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function U(e,t){if(1&e){var n=i.Rb();i.Qb(0,"div",12),i.Qb(1,"user-registration-form",15),i.bc("create",function(e){return i.wc(n),i.dc().onCreate(e)})("update",function(e){return i.wc(n),i.dc().onUpdate(e)})("close",function(){return i.wc(n),i.dc().onClose()}),i.Pb(),i.Pb()}if(2&e){var r=i.dc();i.zb(1),i.lc("user",r.user)}}function S(e,t){1&e&&(i.Qb(0,"div",12),i.Fc(1," detail view "),i.Pb())}var I=function(){function e(e){this.userService=e,this.detailsView=!1,this.userForm=!1,this.loading=!1}return e.prototype.ngOnInit=function(){this.getUserPage()},e.prototype.getUserPage=function(e,t,n){return void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),O(this,void 0,void 0,function(){var r,o;return z(this,function(i){switch(i.label){case 0:this.page=n,i.label=1;case 1:return i.trys.push([1,3,,4]),this.loading=!0,r=this,[4,this.userService.findByUsernameOrPhoneNumber(e,t,n).toPromise()];case 2:return r.users=i.sent(),this.loading=!1,[3,4];case 3:return o=i.sent(),console.log("User list loading error!",o),[3,4];case 4:return[2]}})})},e.prototype.onSearch=function(e){this.userQuery=e,this.getUserPage(e,this.role)},e.prototype.onRoleChange=function(e){this.role=e.length>0?e:null,this.getUserPage(this.userQuery,this.role)},e.prototype.chageRole=function(e,t){return O(this,void 0,void 0,function(){var n,r;return z(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),this.loading=!0,[4,this.userService.changeUserRole(e,t).toPromise()];case 1:return n=o.sent(),this.users.content.splice(this.users.content.findIndex(function(e){return e.id===n.id}),1,n),this.loading=!1,this.user&&this.getUser(this.user.id),[3,3];case 2:return r=o.sent(),console.log("Role change failed",r),[3,3];case 3:return[2]}})})},e.prototype.onEdit=function(e){var t=this.users.content.find(function(t){return t.id===e});this.user=t,this.userForm=!0,this.detailsView=!1},e.prototype.onAddUser=function(e){this.userForm=!0,this.detailsView=!1},e.prototype.onActivate=function(e){return O(this,void 0,void 0,function(){var t,n,r;return z(this,function(o){switch(o.label){case 0:t=this.user?!this.user.enabled:!this.users.content.find(function(t){return t.id===e}).enabled,o.label=1;case 1:return o.trys.push([1,3,,4]),this.loading=!0,[4,this.userService.changeUserEnable(e,t).toPromise()];case 2:return n=o.sent(),this.users.content.splice(this.users.content.findIndex(function(e){return e.id===n.id}),1,n),this.loading=!1,this.user&&this.getUser(this.user.id),[3,4];case 3:return r=o.sent(),console.log("Status change failed",r),[3,4];case 4:return[2]}})})},e.prototype.getUser=function(e){return O(this,void 0,void 0,function(){var t,n;return z(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.loading=!0,t=this,[4,this.userService.getUer(e).toPromise()];case 1:return t.user=r.sent(),this.loading=!1,[3,3];case 2:return n=r.sent(),console.log("GET User failed ",n),[3,3];case 3:return[2]}})})},e.prototype.onCreate=function(e){return O(this,void 0,void 0,function(){var t;return z(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.userService.createAdminUser(e).toPromise()];case 1:return n.sent(),this.userForm=!1,this.getUserPage(),[3,3];case 2:return t=n.sent(),console.log(t),[3,3];case 3:return[2]}})})},e.prototype.onUpdate=function(e){return O(this,void 0,void 0,function(){var t,n;return z(this,function(r){switch(r.label){case 0:e.password=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.userService.createAdminUser(e).toPromise()];case 2:return t=r.sent(),this.users.content.splice(this.users.content.findIndex(function(e){return e.id===t.id}),1,t),this.onClose(),this.getUserPage(this.userQuery,this.role,this.page),[3,4];case 3:return n=r.sent(),console.log(n),[3,4];case 4:return[2]}})})},e.prototype.onClose=function(){this.user=null,this.userForm=!1,this.detailsView=!1},e.\u0275fac=function(t){return new(t||e)(i.Lb(s.a))},e.\u0275cmp=i.Fb({type:e,selectors:[["app-list"]],decls:23,vars:3,consts:[[1,"container-fluid"],[1,"row","px-3","details-title","text-left"],[1,"pull-right"],[1,"form-control",3,"change"],["value","","selected",""],["value","User"],["value","Service Admin"],["value","Service Agent"],["value","Agent"],["value","Admin"],[1,"container"],[1,"row"],[1,"col-md-6"],[3,"users","edit","add","activate","page","search"],["class","col-md-6",4,"ngIf"],[3,"user","create","update","close"]],template:function(e,t){1&e&&(i.Qb(0,"div",0),i.Qb(1,"span",1),i.Fc(2," All User "),i.Qb(3,"span",2),i.Qb(4,"select",3),i.bc("change",function(e){return t.onRoleChange(e.target.value)}),i.Qb(5,"option",4),i.Fc(6,"All"),i.Pb(),i.Qb(7,"option",5),i.Fc(8,"User"),i.Pb(),i.Qb(9,"option",6),i.Fc(10,"Hotel Admin"),i.Pb(),i.Qb(11,"option",7),i.Fc(12,"Hotel Agent"),i.Pb(),i.Qb(13,"option",8),i.Fc(14,"Agent"),i.Pb(),i.Qb(15,"option",9),i.Fc(16,"Admin "),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Qb(17,"div",10),i.Qb(18,"div",11),i.Qb(19,"div",12),i.Qb(20,"user-list",13),i.bc("edit",function(e){return t.onEdit(e)})("add",function(e){return t.onAddUser(e)})("activate",function(e){return t.onActivate(e)})("page",function(e){return t.getUserPage(t.userQuery,t.role,e)})("search",function(e){return t.onSearch(e)}),i.Pb(),i.Pb(),i.Dc(21,U,2,1,"div",14),i.Dc(22,S,2,0,"div",14),i.Pb(),i.Pb()),2&e&&(i.zb(20),i.lc("users",t.users),i.zb(1),i.lc("ngIf",t.userForm),i.zb(1),i.lc("ngIf",t.detailsView))},directives:[u.q,u.w,g,l.q,M],styles:[".btn-web[_ngcontent-%COMP%], .hotel-button[_ngcontent-%COMP%]{color:#fff;background-color:#3f87c7}.hotel-button-reverse[_ngcontent-%COMP%], .hotel-button[_ngcontent-%COMP%]:hover{background-color:#f7a71a}.hotel-button-reverse[_ngcontent-%COMP%]{color:#fff}.hotel-button-reverse[_ngcontent-%COMP%]:hover{background-color:#3f87c7}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.15rem .75rem}.user_role[_ngcontent-%COMP%]{background:#1b2445;color:#fff;padding:0 4px;border-radius:5px;font-family:monospace;font-size:12px}"]}),e}(),A=n("d26D");function k(e,t){if(1&e){var n=i.Rb();i.Qb(0,"tr"),i.Qb(1,"td"),i.Fc(2),i.Pb(),i.Qb(3,"td"),i.Fc(4),i.Pb(),i.Qb(5,"td"),i.Fc(6),i.Pb(),i.Qb(7,"td"),i.Qb(8,"div",14),i.Qb(9,"button",15),i.bc("click",function(){i.wc(n);var e=t.$implicit;return i.dc().onEdit(e.id)}),i.Mb(10,"i",16),i.Pb(),i.Pb(),i.Pb(),i.Pb()}if(2&e){var r=t.$implicit;i.zb(2),i.Gc(r.name),i.zb(2),i.Gc(r.phoneNumber),i.zb(2),i.Gc(r.enabled)}}function N(e,t){if(1&e){var n=i.Rb();i.Qb(0,"pagination",17),i.bc("getPage",function(e){return i.wc(n),i.dc().getHotelPage(e)}),i.Pb()}if(2&e){var r=i.dc();i.lc("page",r.hotelPage)("short",r.short)}}var _=function(){function e(){this.search=new i.n,this.edit=new i.n,this.page=new i.n}return e.prototype.ngOnInit=function(){},e.prototype.submit=function(){this.search.emit(this.hotelQuery)},e.prototype.onEdit=function(e){this.edit.emit(e)},e.prototype.getHotelPage=function(e){this.page.emit(e)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Fb({type:e,selectors:[["hotel-list"]],inputs:{hotelPage:"hotelPage"},outputs:{search:"search",edit:"edit",page:"page"},decls:31,vars:3,consts:[[1,"table","border"],[2,"background-color","#f8f9fa"],["colspan","4"],[1,"row"],[1,"col"],[1,"mr-auto"],[1,"mx-3","my-1",3,"ngSubmit"],[1,"input-group","mb-2"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"fa","fa-search"],["type","text","id","userQuery","name","userQuery","placeholder","Hotel name ",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[3,"page","short","getPage",4,"ngIf"],["role","group","aria-label","Basic example",1,"btn-group"],["type","button",1,"btn","btn-light",3,"click"],[1,"fa","fa-pencil-square-o"],[3,"page","short","getPage"]],template:function(e,t){1&e&&(i.Qb(0,"table",0),i.Qb(1,"thead"),i.Qb(2,"tr",1),i.Qb(3,"td",2),i.Qb(4,"div",3),i.Qb(5,"div",4),i.Qb(6,"h5",5),i.Fc(7,"Hotel List"),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Qb(8,"tr"),i.Qb(9,"td",2),i.Qb(10,"form",6),i.bc("ngSubmit",function(){return t.submit()}),i.Qb(11,"div",7),i.Qb(12,"div",8),i.Qb(13,"div",9),i.Mb(14,"i",10),i.Fc(15,"\xa0 Search "),i.Pb(),i.Pb(),i.Qb(16,"input",11),i.bc("ngModelChange",function(e){return t.hotelQuery=e}),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Qb(17,"tr"),i.Qb(18,"th"),i.Fc(19,"Name"),i.Pb(),i.Qb(20,"th"),i.Fc(21,"Phone"),i.Pb(),i.Qb(22,"th"),i.Fc(23,"Enabled"),i.Pb(),i.Mb(24,"th"),i.Pb(),i.Pb(),i.Qb(25,"tbody"),i.Dc(26,k,11,3,"tr",12),i.Pb(),i.Qb(27,"tfoot"),i.Qb(28,"tr"),i.Qb(29,"td",2),i.Dc(30,N,1,2,"pagination",13),i.Pb(),i.Pb(),i.Pb(),i.Pb()),2&e&&(i.zb(16),i.lc("ngModel",t.hotelQuery),i.zb(10),i.lc("ngForOf",null==t.hotelPage?null:t.hotelPage.content),i.zb(4),i.lc("ngIf",null!=t.hotelPage))},directives:[u.x,u.n,u.o,u.b,u.m,u.p,l.p,l.q,b.a],styles:[".table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.15rem .75rem}"]}),e}();function E(e,t){if(1&e&&(i.Qb(0,"option",11),i.Fc(1),i.Pb()),2&e){var n=t.$implicit;i.lc("value",n.key),i.zb(1),i.Hc(" ",n.value," ")}}var R=function(e){return{disabled:e}};function D(e,t){if(1&e&&(i.Qb(0,"button",12),i.Fc(1," Submit "),i.Pb()),2&e){var n=i.dc();i.lc("ngClass",i.pc(1,R,n.form.invalid))}}var H=function(){function e(e){this.builder=e,this.role=new i.n,this.close=new i.n,this.roleEnum=a}return e.prototype.ngOnInit=function(){this.createForm()},e.prototype.createForm=function(){this.form=this.builder.group({role:["",u.v.required]})},e.prototype.submit=function(){this.form.valid&&(this.role.emit(this.form.value),this.form.reset())},e.prototype.onClose=function(){this.close.emit()},e.\u0275fac=function(t){return new(t||e)(i.Lb(u.d))},e.\u0275cmp=i.Fb({type:e,selectors:[["assign-user-form"]],inputs:{hotel:"hotel",user:"user"},outputs:{role:"role",close:"close"},decls:21,vars:7,consts:[[3,"formGroup","ngSubmit"],[1,"form-group"],["for","hotelName"],[1,"form-control"],["for","userName"],["for","role"],["id","role","formControlName","role",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"d-flex","flex-row-reverse","bd-highlight"],["type","submit","class","btn btn-success mx-1","type","submit",3,"ngClass",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-danger",3,"click"],[3,"value"],["type","submit","type","submit",1,"btn","btn-success","mx-1",3,"ngClass"]],template:function(e,t){1&e&&(i.Qb(0,"form",0),i.bc("ngSubmit",function(){return t.submit()}),i.Qb(1,"div",1),i.Qb(2,"label",2),i.Fc(3,"Hotel Name *"),i.Pb(),i.Qb(4,"label",3),i.Fc(5),i.Pb(),i.Pb(),i.Qb(6,"div",1),i.Qb(7,"label",4),i.Fc(8,"User Name *"),i.Pb(),i.Qb(9,"label",3),i.Fc(10),i.Pb(),i.Pb(),i.Qb(11,"div",1),i.Qb(12,"label",5),i.Fc(13,"Role "),i.Pb(),i.Qb(14,"select",6),i.Dc(15,E,2,2,"option",7),i.ec(16,"keyvalue"),i.Pb(),i.Pb(),i.Qb(17,"div",8),i.Dc(18,D,2,3,"button",9),i.Qb(19,"button",10),i.bc("click",function(){return t.onClose()}),i.Fc(20,"Close"),i.Pb(),i.Pb(),i.Pb()),2&e&&(i.lc("formGroup",t.form),i.zb(5),i.Hc(" ",null==t.hotel?null:t.hotel.name," "),i.zb(5),i.Hc(" ",null==t.user?null:t.user.name," "),i.zb(5),i.lc("ngForOf",i.fc(16,5,t.roleEnum)),i.zb(3),i.lc("ngIf",(null==t.hotel?null:t.hotel.id)&&(null==t.user?null:t.user.id)))},directives:[u.x,u.n,u.g,u.u,u.m,u.f,l.p,l.q,u.q,u.w,l.o],pipes:[l.k],styles:[""]}),e}(),q=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function c(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,s)}u((r=r.apply(e,t||[])).next())})},G=function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function L(e,t){if(1&e){var n=i.Rb();i.Qb(0,"div",10),i.Qb(1,"h5",11),i.Fc(2,"Assign user"),i.Pb(),i.Qb(3,"div",12),i.Qb(4,"assign-user-form",13),i.bc("role",function(e){return i.wc(n),i.dc().onSaveRole(e)})("close",function(){return i.wc(n),i.dc().onClose()}),i.Pb(),i.Pb(),i.Pb()}if(2&e){var r=i.dc();i.zb(4),i.lc("hotel",r.hotel)("user",r.user)}}function $(e,t){if(1&e&&(i.Qb(0,"span"),i.Fc(1),i.Pb()),2&e){var n=t.$implicit;i.zb(1),i.Hc(" ",n.name," ")}}function V(e,t){if(1&e){var n=i.Rb();i.Qb(0,"tr"),i.Qb(1,"td"),i.Fc(2),i.Pb(),i.Qb(3,"td"),i.Fc(4),i.Pb(),i.Qb(5,"td"),i.Dc(6,$,2,1,"span",20),i.Pb(),i.Qb(7,"td"),i.Qb(8,"i",21),i.bc("click",function(){i.wc(n);var e=t.$implicit,r=i.dc(2);return r.onRemove(e.id,r.hotel.id)}),i.Pb(),i.Pb(),i.Pb()}if(2&e){var r=t.$implicit;i.zb(2),i.Hc(" ",r.name," "),i.zb(2),i.Hc(" ",r.phoneNumber," "),i.zb(2),i.lc("ngForOf",null==r?null:r.roles)}}function T(e,t){if(1&e&&(i.Qb(0,"div",14),i.Qb(1,"table",15),i.Qb(2,"thead"),i.Qb(3,"tr",16),i.Qb(4,"td",17),i.Qb(5,"div",6),i.Qb(6,"div",18),i.Qb(7,"h5",19),i.Fc(8),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Qb(9,"tr"),i.Qb(10,"th"),i.Fc(11,"Name"),i.Pb(),i.Qb(12,"th"),i.Fc(13,"Phone, Email"),i.Pb(),i.Qb(14,"th"),i.Fc(15,"Staus"),i.Pb(),i.Mb(16,"th"),i.Pb(),i.Pb(),i.Qb(17,"tbody"),i.Dc(18,V,9,3,"tr",20),i.Pb(),i.Pb(),i.Pb()),2&e){var n=i.dc();i.zb(8),i.Hc("",n.hotel.name," - User list"),i.zb(10),i.lc("ngForOf",n.hotelUser)}}var j=function(){function e(e,t){this.hotelService=e,this.userService=t,this.loading=!1,this.short=!0}return e.prototype.ngOnInit=function(){this.getAdminHotelPage(),this.getUserPage()},e.prototype.getAdminHotelPage=function(e){return void 0===e&&(e=0),q(this,void 0,void 0,function(){var t=this;return G(this,function(n){switch(n.label){case 0:return[4,this.hotelService.getAdminHotelPage(e,this.hotelName).subscribe(function(e){t.hotelPage=e})];case 1:return n.sent(),[2]}})})},e.prototype.getUserPage=function(e,t,n){return void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),q(this,void 0,void 0,function(){var r=this;return G(this,function(o){switch(o.label){case 0:return this.loading=!0,[4,this.userService.findByUsernameOrPhoneNumber(e,t,n).subscribe(function(e){r.userPage=e,r.loading=!1},function(e){return console.log("User list loading error!",e)})];case 1:return o.sent(),[2]}})})},e.prototype.onSearchUser=function(e){this.getUserPage(e,this.role)},e.prototype.onSearchHotel=function(e){this.hotelName=e,this.getAdminHotelPage()},e.prototype.getAdminHotelUser=function(e){return q(this,void 0,void 0,function(){var t,n;return G(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=this,[4,this.userService.getHotelUsers(e).toPromise()];case 1:return t.hotelUser=r.sent(),[3,3];case 2:return n=r.sent(),console.log(n),[3,3];case 3:return[2]}})})},e.prototype.onSelectUser=function(e){var t=this.userPage.content.find(function(t){return t.id===e});this.user=t},e.prototype.onSelectHotel=function(e){var t=this.hotelPage.content.find(function(t){return t.id===e});this.hotel=t,this.getAdminHotelUser(e)},e.prototype.onSaveRole=function(e){return q(this,void 0,void 0,function(){var t;return G(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.userService.assignHotel(this.user.id,this.hotel.id,e.role).toPromise()];case 1:return n.sent(),console.log("Assign user success"),this.onClose(),[3,3];case 2:return t=n.sent(),console.log(t),[3,3];case 3:return[2]}})})},e.prototype.onClose=function(){this.hotelUser=null,this.hotel=null,this.user=null},e.prototype.onRemove=function(e,t){return q(this,void 0,void 0,function(){var n,r;return G(this,function(o){switch(o.label){case 0:if(n=this.hotelUser.find(function(t){return t.id==e}),!confirm("Are you sure to remove "+n.name))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.userService.removeUserHotel(e,t).toPromise()];case 2:return o.sent(),console.log("Hotel removed from user"),this.getAdminHotelUser(t),[3,4];case 3:return r=o.sent(),console.log(r),[3,4];case 4:return[2]}})})},e.\u0275fac=function(t){return new(t||e)(i.Lb(A.a),i.Lb(s.a))},e.\u0275cmp=i.Fb({type:e,selectors:[["app-assign-user"]],decls:13,vars:5,consts:[[1,"container-fluid"],[1,"row","px-3","details-title","text-left"],[1,"container"],[1,"row","m-0"],["class","offset-md-3 col-md-4 border p-0 mb-3",4,"ngIf"],["class","col-md-4",4,"ngIf"],[1,"row"],[1,"col-md-6"],[3,"users","short","page","search","edit"],[3,"hotelPage","search","edit","page"],[1,"offset-md-3","col-md-4","border","p-0","mb-3"],[2,"background-color","#f8f9fa","padding","8px"],[1,"p-3"],[3,"hotel","user","role","close"],[1,"col-md-4"],[1,"table","border"],[2,"background-color","#f8f9fa"],["colspan","4"],[1,"col"],[1,"mr-auto"],[4,"ngFor","ngForOf"],[1,"fa","fa-trash-o",2,"cursor","pointer",3,"click"]],template:function(e,t){1&e&&(i.Qb(0,"div",0),i.Qb(1,"span",1),i.Fc(2," Assign User "),i.Pb(),i.Pb(),i.Qb(3,"div",2),i.Qb(4,"div",3),i.Dc(5,L,5,2,"div",4),i.Dc(6,T,19,2,"div",5),i.Pb(),i.Pb(),i.Qb(7,"div",2),i.Qb(8,"div",6),i.Qb(9,"div",7),i.Qb(10,"user-list",8),i.bc("page",function(e){return t.getUserPage(t.userQuery,t.role,e)})("search",function(e){return t.onSearchUser(e)})("edit",function(e){return t.onSelectUser(e)}),i.Pb(),i.Pb(),i.Qb(11,"div",7),i.Qb(12,"hotel-list",9),i.bc("search",function(e){return t.onSearchHotel(e)})("edit",function(e){return t.onSelectHotel(e)})("page",function(e){return t.getAdminHotelPage(e)}),i.Pb(),i.Pb(),i.Pb(),i.Pb()),2&e&&(i.zb(5),i.lc("ngIf",t.user||t.hotel),i.zb(1),i.lc("ngIf",t.hotelUser),i.zb(4),i.lc("users",t.userPage)("short",!0),i.zb(2),i.lc("hotelPage",t.hotelPage))},directives:[l.q,g,_,H,l.p],styles:[".table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.15rem .75rem}"]}),e}(),B=function(){return(B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function J(e,t){1&e&&(i.Qb(0,"small",16),i.Fc(1," Name required "),i.Pb())}function K(e,t){if(1&e&&(i.Qb(0,"small",16),i.Qb(1,"div",17),i.Fc(2," Phone number required "),i.Pb(),i.Qb(3,"div",17),i.Fc(4," Phone number format 01934953023 "),i.Pb(),i.Pb()),2&e){var n=i.dc();i.zb(1),i.lc("hidden",!n.form.controls.phoneNumber.errors.required),i.zb(2),i.lc("hidden",!n.form.controls.phoneNumber.errors.pattern)}}function W(e,t){1&e&&(i.Qb(0,"small",16),i.Fc(1," Commission Percent required "),i.Pb())}function X(e,t){if(1&e){var n=i.Rb();i.Qb(0,"button",18),i.bc("click",function(){i.wc(n);var e=i.dc();return e.onRemoveAgent(e.user.id)}),i.Fc(1," Remove this agent "),i.Pb()}}var Y=function(e,t,n){return{disabled:e,"btn-warning":t,"btn-success":n}},Z=function(){function e(e){this.builder=e,this.create=new i.n,this.removeAgent=new i.n,this.exists=!1,this.createForm()}return e.prototype.ngOnChanges=function(e){e.user&&this.user&&this.user.id&&(this.exists=!0,this.form.patchValue(B({},{name:this.user.name,phoneNumber:this.user.phoneNumber,email:this.user.email,commissionPercent:this.user.commissionPercent})))},e.prototype.createForm=function(){this.form=this.builder.group({name:["",u.v.required],phoneNumber:["",[u.v.required,u.v.pattern("^01[3-9][ ]?[0-9]{2}[ ]?[0-9]{3}[ ]?[0-9]{3}$")]],email:"",commissionPercent:["",u.v.required]})},e.prototype.submit=function(){if(this.form.valid){if(this.exists){var e=B(B({},this.user),this.form.value);this.create.emit(e)}else this.create.emit(this.form.value);this.onClear()}},e.prototype.onRemoveAgent=function(e){this.removeAgent.emit(e),this.onClear()},e.prototype.onClear=function(){this.form.reset(),this.exists=!1},e.\u0275fac=function(t){return new(t||e)(i.Lb(u.d))},e.\u0275cmp=i.Fb({type:e,selectors:[["admin-agent-form"]],inputs:{user:"user"},outputs:{create:"create",removeAgent:"removeAgent"},features:[i.xb],decls:27,vars:11,consts:[[3,"formGroup","ngSubmit"],[1,"form-row"],[1,"form-group","col-md-6"],["for","name"],["id","name","placeholder","Name","formControlName","name",1,"form-control"],["class","text-danger",4,"ngIf"],["for","phone"],["placeholder","Phone","id","phone","maxlength","11","formControlName","phoneNumber",1,"form-control"],["for","email"],["type","email","id","email","placeholder","Email","formControlName","email",1,"form-control"],["for","commissionPercent"],["id","commissionPercent","placeholder","Commission Percent","formControlName","commissionPercent",1,"form-control"],[1,"d-flex","flex-row-reverse","bd-highlight","my-2","mb-5"],["type","submit",1,"btn","btn-sm","mx-1",3,"ngClass"],["type","button","class","btn btn-sm btn-success mx-1",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-danger","mx-1",3,"click"],[1,"text-danger"],[3,"hidden"],["type","button",1,"btn","btn-sm","btn-success","mx-1",3,"click"]],template:function(e,t){1&e&&(i.Qb(0,"form",0),i.bc("ngSubmit",function(){return t.submit()}),i.Qb(1,"div",1),i.Qb(2,"div",2),i.Qb(3,"label",3),i.Fc(4,"Name *"),i.Pb(),i.Mb(5,"input",4),i.Dc(6,J,2,0,"small",5),i.Pb(),i.Qb(7,"div",2),i.Qb(8,"label",6),i.Fc(9,"Phone *"),i.Pb(),i.Mb(10,"input",7),i.Dc(11,K,5,2,"small",5),i.Pb(),i.Qb(12,"div",2),i.Qb(13,"label",8),i.Fc(14,"Email"),i.Pb(),i.Mb(15,"input",9),i.Pb(),i.Qb(16,"div",2),i.Qb(17,"label",10),i.Fc(18,"Commission Percent *"),i.Pb(),i.Mb(19,"input",11),i.Dc(20,W,2,0,"small",5),i.Pb(),i.Pb(),i.Qb(21,"div",12),i.Qb(22,"button",13),i.Fc(23),i.Pb(),i.Dc(24,X,2,0,"button",14),i.Qb(25,"button",15),i.bc("click",function(){return t.onClear()}),i.Fc(26," Clear "),i.Pb(),i.Pb(),i.Pb()),2&e&&(i.lc("formGroup",t.form),i.zb(6),i.lc("ngIf",t.form.controls.name.errors&&t.form.controls.name.touched),i.zb(5),i.lc("ngIf",t.form.controls.phoneNumber.errors&&t.form.controls.phoneNumber.touched),i.zb(9),i.lc("ngIf",t.form.controls.commissionPercent.errors&&t.form.controls.commissionPercent.touched),i.zb(2),i.lc("ngClass",i.rc(7,Y,t.form.invalid,t.exists,!t.exists)),i.zb(1),i.Hc(" ",t.exists?"Update":"Create"," User "),i.zb(1),i.lc("ngIf",t.exists))},directives:[u.x,u.n,u.g,u.b,u.m,u.f,l.q,u.j,l.o],styles:[""]}),e}(),ee=n("HF3I"),te=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function c(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,s)}u((r=r.apply(e,t||[])).next())})},ne=function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function re(e,t){1&e&&i.Mb(0,"loading")}function oe(e,t){if(1&e){var n=i.Rb();i.Qb(0,"tr"),i.Qb(1,"td"),i.Fc(2),i.Pb(),i.Qb(3,"td"),i.Fc(4),i.Pb(),i.Qb(5,"td"),i.Fc(6),i.Pb(),i.Qb(7,"td"),i.Fc(8),i.Pb(),i.Qb(9,"td"),i.Qb(10,"button",18),i.bc("click",function(){i.wc(n);var e=t.$implicit;return i.dc(2).onSelect(e.id)}),i.Mb(11,"i",19),i.Pb(),i.Pb(),i.Pb()}if(2&e){var r=t.$implicit;i.zb(2),i.Gc(r.name),i.zb(2),i.Gc(r.phoneNumber),i.zb(2),i.Gc(r.commissionPercent),i.zb(2),i.Gc(r.email)}}function ie(e,t){if(1&e){var n=i.Rb();i.Qb(0,"table",14),i.Qb(1,"thead"),i.Qb(2,"tr"),i.Qb(3,"th"),i.Fc(4,"Name"),i.Pb(),i.Qb(5,"th"),i.Fc(6,"Phone"),i.Pb(),i.Qb(7,"th"),i.Fc(8,"Commission Percent"),i.Pb(),i.Qb(9,"th"),i.Fc(10,"Email"),i.Pb(),i.Mb(11,"th"),i.Pb(),i.Pb(),i.Qb(12,"tbody"),i.Dc(13,oe,12,4,"tr",15),i.Pb(),i.Qb(14,"tfoot"),i.Qb(15,"tr"),i.Qb(16,"td",16),i.Qb(17,"pagination",17),i.bc("getPage",function(e){return i.wc(n),i.dc().getUserPage(e)}),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Pb()}if(2&e){var r=i.dc();i.zb(13),i.lc("ngForOf",null==r.userPage?null:r.userPage.content),i.zb(4),i.lc("page",r.userPage)}}var ce=function(){function e(e){this.userService=e,this.role="Agent",this.loading=!1}return e.prototype.ngOnInit=function(){this.getUserPage(this.userQuery,this.role)},e.prototype.getUserPage=function(e,t,n){return void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),te(this,void 0,void 0,function(){var r=this;return ne(this,function(o){switch(o.label){case 0:return this.loading=!0,[4,this.userService.findByUsernameOrPhoneNumber(e,t,n).subscribe(function(e){r.userPage=e,r.loading=!1},function(e){return console.log("User list loading error!",e)})];case 1:return o.sent(),[2]}})})},e.prototype.submit=function(){this.getUserPage(this.userQuery,this.role)},e.prototype.onCreate=function(e){return te(this,void 0,void 0,function(){var t=this;return ne(this,function(n){switch(n.label){case 0:return[4,this.userService.createAdminAgent(e).subscribe(function(e){t.getUserPage(t.userQuery,t.role)})];case 1:return n.sent(),[2]}})})},e.prototype.onSelect=function(e){var t=this.userPage.content.find(function(t){return t.id===e});this.user=t},e.prototype.onRemoveAgent=function(e){return te(this,void 0,void 0,function(){var t=this;return ne(this,function(n){switch(n.label){case 0:return console.log("On leave ",e),[4,this.userService.removeAdminAgent(e).subscribe(function(e){t.getUserPage(t.userQuery,t.role)})];case 1:return n.sent(),[2]}})})},e.\u0275fac=function(t){return new(t||e)(i.Lb(s.a))},e.\u0275cmp=i.Fb({type:e,selectors:[["app-admin-agent"]],decls:21,vars:4,consts:[[1,"container-fluid"],[1,"row","px-3","details-title","text-left"],[1,"row"],[1,"col-md-6"],[1,"text-center"],[1,"mx-3","my-1",3,"ngSubmit"],[1,"input-group","mb-2"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"fa","fa-search"],["type","text","id","userQuery","name","userQuery","placeholder","User name or phone",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngIf"],["class","table border",4,"ngIf"],[3,"user","create","removeAgent"],[1,"table","border"],[4,"ngFor","ngForOf"],["colspan","5"],[3,"page","getPage"],[1,"btn-sm","btn-warning",3,"click"],[1,"fa","fa-pencil-square-o"]],template:function(e,t){1&e&&(i.Qb(0,"div",0),i.Qb(1,"span",1),i.Fc(2,"Agents"),i.Pb(),i.Pb(),i.Qb(3,"div",0),i.Qb(4,"div",2),i.Qb(5,"div",3),i.Qb(6,"h3",4),i.Fc(7,"Agent list"),i.Pb(),i.Qb(8,"form",5),i.bc("ngSubmit",function(){return t.submit()}),i.Qb(9,"div",6),i.Qb(10,"div",7),i.Qb(11,"div",8),i.Mb(12,"i",9),i.Fc(13,"\xa0 Search"),i.Pb(),i.Pb(),i.Qb(14,"input",10),i.bc("ngModelChange",function(e){return t.userQuery=e}),i.Pb(),i.Pb(),i.Pb(),i.Dc(15,re,1,0,"loading",11),i.Dc(16,ie,18,2,"table",12),i.Pb(),i.Qb(17,"div",3),i.Qb(18,"h3",4),i.Fc(19,"Add Agent"),i.Pb(),i.Qb(20,"admin-agent-form",13),i.bc("create",function(e){return t.onCreate(e)})("removeAgent",function(e){return t.onRemoveAgent(e)}),i.Pb(),i.Pb(),i.Pb(),i.Pb()),2&e&&(i.zb(14),i.lc("ngModel",t.userQuery),i.zb(1),i.lc("ngIf",t.loading),i.zb(1),i.lc("ngIf",!t.loading),i.zb(4),i.lc("user",t.user))},directives:[u.x,u.n,u.o,u.b,u.m,u.p,l.q,Z,ee.a,l.p,b.a],styles:[".table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.15rem .75rem}"]}),e}(),se=n("WGvi"),ue=function(){return(ue=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ae=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function c(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,s)}u((r=r.apply(e,t||[])).next())})},le=function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(s){i=[6,s],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function be(e,t){1&e&&i.Mb(0,"loading")}function fe(e,t){if(1&e&&(i.Qb(0,"span"),i.Fc(1),i.Pb()),2&e){var n=t.$implicit;i.zb(1),i.Hc(" ",n.name," ")}}function de(e,t){if(1&e){var n=i.Rb();i.Qb(0,"tr"),i.Qb(1,"td"),i.Fc(2),i.Pb(),i.Qb(3,"td"),i.Fc(4),i.Pb(),i.Qb(5,"td"),i.Fc(6),i.Pb(),i.Qb(7,"td"),i.Dc(8,fe,2,1,"span",16),i.Pb(),i.Qb(9,"td",17),i.Qb(10,"button",18),i.bc("click",function(){i.wc(n);var e=t.$implicit;return i.dc(2).onEdit(e.id)}),i.Mb(11,"i",19),i.Pb(),i.Pb(),i.Pb()}if(2&e){var r=t.$implicit;i.zb(2),i.Gc(r.name),i.zb(2),i.Gc(r.phoneNumber),i.zb(2),i.Gc(r.email),i.zb(2),i.lc("ngForOf",null==r?null:r.roles)}}function he(e,t){if(1&e&&(i.Qb(0,"tbody"),i.Dc(1,de,12,4,"tr",16),i.Pb()),2&e){var n=i.dc();i.zb(1),i.lc("ngForOf",n.userPage.content)}}function pe(e,t){if(1&e){var n=i.Rb();i.Qb(0,"pagination",20),i.bc("getPage",function(e){i.wc(n);var t=i.dc();return t.getUserPage(t.userQuery,t.role,e)}),i.Pb()}if(2&e){var r=i.dc();i.lc("page",r.userPage)}}function me(e,t){if(1&e){var n=i.Rb();i.Qb(0,"div",3),i.Qb(1,"change-password-form",21),i.bc("create",function(e){return i.wc(n),i.dc().onChangePassword(e)}),i.Pb(),i.Pb()}if(2&e){var r=i.dc();i.zb(1),i.lc("user",r.user)}}function ge(e,t){1&e&&(i.Qb(0,"div",3),i.Qb(1,"div",22),i.Fc(2," Congratulation! Password changed successfully "),i.Pb(),i.Pb())}var Pe=[{path:"add",component:c},{path:"assign",component:j},{path:"admin-agent",component:ce},{path:"change-password",component:function(){function e(e){this.userService=e,this.loading=!1,this.successMessage=!1}return e.prototype.ngOnInit=function(){this.getUserPage()},e.prototype.getUserPage=function(e,t,n){return void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),ae(this,void 0,void 0,function(){var r=this;return le(this,function(o){switch(o.label){case 0:return this.loading=!0,[4,this.userService.findByUsernameOrPhoneNumber(e,t,n).subscribe(function(e){r.userPage=e,r.loading=!1},function(e){return console.log("User list loading error!",e)})];case 1:return o.sent(),[2]}})})},e.prototype.submit=function(){this.getUserPage(this.userQuery,this.role)},e.prototype.onEdit=function(e){this.successMessage=!1;var t=this.userPage.content.find(function(t){return t.id===e});this.user=ue({},t)},e.prototype.onChangePassword=function(e){return ae(this,void 0,void 0,function(){var t=this;return le(this,function(n){switch(n.label){case 0:return console.log(e.id,e.password),[4,this.userService.changeUserPasswordByAdmin(e.id,e.password).subscribe(function(e){t.user=null,t.successMessage=!0,console.log(e)})];case 1:return n.sent(),[2]}})})},e.\u0275fac=function(t){return new(t||e)(i.Lb(s.a))},e.\u0275cmp=i.Fb({type:e,selectors:[["app-change-password"]],decls:35,vars:6,consts:[[1,"container-fluid"],[1,"row","px-3","details-title","text-left"],[1,"row"],[1,"col-md-6"],[1,"text-center"],[4,"ngIf"],[1,"mx-3","my-1",3,"ngSubmit"],[1,"input-group","mb-2"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"fa","fa-search"],["type","text","id","userQuery","name","userQuery","placeholder","User name or phone",1,"form-control",3,"ngModel","ngModelChange"],[1,"table","border","table-responsive-sm"],["colspan","5"],[3,"page","getPage",4,"ngIf"],["class","col-md-6",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"text-right"],[1,"btn","btn-warning","btn-sm",3,"click"],[1,"fa","fa-edit"],[3,"page","getPage"],[3,"user","create"],["role","alert",1,"alert","alert-success"]],template:function(e,t){1&e&&(i.Qb(0,"div",0),i.Qb(1,"span",1),i.Fc(2," Change password "),i.Pb(),i.Pb(),i.Qb(3,"div",0),i.Qb(4,"div",2),i.Qb(5,"div",3),i.Qb(6,"h3",4),i.Fc(7,"User List"),i.Pb(),i.Dc(8,be,1,0,"loading",5),i.Qb(9,"form",6),i.bc("ngSubmit",function(){return t.submit()}),i.Qb(10,"div",7),i.Qb(11,"div",8),i.Qb(12,"div",9),i.Mb(13,"i",10),i.Fc(14,"\xa0 Search "),i.Pb(),i.Pb(),i.Qb(15,"input",11),i.bc("ngModelChange",function(e){return t.userQuery=e}),i.Pb(),i.Pb(),i.Pb(),i.Qb(16,"table",12),i.Qb(17,"thead"),i.Qb(18,"tr"),i.Qb(19,"th"),i.Fc(20,"Name"),i.Pb(),i.Qb(21,"th"),i.Fc(22,"Phone"),i.Pb(),i.Qb(23,"th"),i.Fc(24,"Email"),i.Pb(),i.Qb(25,"th"),i.Fc(26,"Role"),i.Pb(),i.Mb(27,"th"),i.Pb(),i.Pb(),i.Dc(28,he,2,1,"tbody",5),i.Qb(29,"tfoot"),i.Qb(30,"tr"),i.Qb(31,"td",13),i.Dc(32,pe,1,1,"pagination",14),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Pb(),i.Dc(33,me,2,1,"div",15),i.Dc(34,ge,3,0,"div",15),i.Pb(),i.Pb()),2&e&&(i.zb(8),i.lc("ngIf",t.loading),i.zb(7),i.lc("ngModel",t.userQuery),i.zb(13),i.lc("ngIf",(null==t.userPage?null:t.userPage.content.length)>0),i.zb(4),i.lc("ngIf",null!=t.userPage),i.zb(1),i.lc("ngIf",t.user),i.zb(1),i.lc("ngIf",t.successMessage))},directives:[l.q,u.x,u.n,u.o,u.b,u.m,u.p,ee.a,l.p,b.a,se.a],styles:[".table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.15rem}"]}),e}()},{path:"",component:I}],ve=function(){function e(){}return e.\u0275mod=i.Jb({type:e}),e.\u0275inj=i.Ib({factory:function(t){return new(t||e)},imports:[[o.a,r.e.forChild(Pe)]]}),e}()}}]);