(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{wXy8:function(o,t,n){"use strict";n.r(t),n.d(t,"ROUTES",function(){return Go}),n.d(t,"AdminBookingModule",function(){return Ro});var e=n("/e7+"),i=n("FJeW"),r=n("Sa+r"),c=n("ITiG"),a=n("0sMf"),l=n("fXoL"),b=n("tyNb"),s=n("1kSV"),u=n("ofXK"),g=n("/YPm"),d=n("yBZE"),f=n("B01t"),h=n("HF3I"),m=function(){return(m=Object.assign||function(o){for(var t,n=1,e=arguments.length;n<e;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};function p(o,t){if(1&o){var n=l.Ub();l.Tb(0,"span"),l.Tb(1,"button",16),l.ec("click",function(){l.zc(n);var o=t.$implicit;return l.gc(2).onSelectCategory(o)}),l.Gc(2),l.Sb(),l.Sb()}if(2&o){var e=t.$implicit,i=l.gc(2);l.Bb(1),l.oc("ngClass",e==i.category?"btn-primary":"btn-secondary"),l.Bb(1),l.Ic(" ",e," ")}}var v=function(o,t){return{disabled:o,selected:t}};function S(o,t){if(1&o){var n=l.Ub();l.Tb(0,"div",17),l.Tb(1,"div",18),l.ec("click",function(){l.zc(n);var o=t.$implicit;return l.gc(2).onRoomSelect(o.id,o.available)}),l.Gc(2),l.Sb(),l.Sb()}if(2&o){var e=t.$implicit;l.Bb(1),l.oc("ngClass",l.tc(2,v,!e.available,e.selected)),l.Bb(1),l.Ic(" ",e.roomNumber," ")}}function k(o,t){if(1&o&&(l.Tb(0,"div"),l.Tb(1,"div",11),l.Tb(2,"div",12),l.Tb(3,"h4"),l.Gc(4),l.Sb(),l.Sb(),l.Ec(5,p,3,2,"span",13),l.Sb(),l.Tb(6,"div",14),l.Ec(7,S,3,5,"div",15),l.Sb(),l.Sb()),2&o){var n=l.gc();l.Bb(4),l.Hc(n.hotel.name),l.Bb(1),l.oc("ngForOf",n.categoryList),l.Bb(2),l.oc("ngForOf",n.filteredRoomList)}}function y(o,t){if(1&o&&l.Pb(0,"loading",19),2&o){var n=l.gc();l.oc("message",n.message)}}var T=function(){function o(o,t){this.roomService=o,this.util=t,this.showHotels=new l.n,this.roomSelected=new l.n,this.daterange={},this.showRoomListLoading=!1,this.message=""}return o.prototype.ngOnInit=function(){this.setDateRanges(),this.hotel&&this.getAdminAvailableRoomList(this.hotel.id,this.daterange.checkinDate,this.daterange.checkoutDate)},o.prototype.ngOnChanges=function(o){var t=this;if(o.unSelect&&o.unSelect.currentValue&&this.roomList&&this.roomList.length>0){var n=this.roomList.find(function(o){return o.id===t.unSelect}),e=m(m({},n),{selected:!1});this.roomList.splice(this.roomList.findIndex(function(o){return o.id==t.unSelect}),1,e)}o.reloadRoomList&&this.daterange&&this.daterange.checkinDate&&this.daterange.checkoutDate&&this.reload(this.hotel.id,this.daterange.checkinDate,this.daterange.checkoutDate)},o.prototype.setDateRanges=function(){this.daterange.checkinDate=new Date,this.daterange.checkoutDate=new Date,this.daterange.checkoutDate.setDate(this.daterange.checkoutDate.getDate()+1);var o=new Date;o.setDate(this.daterange.checkinDate.getDate()+90);var t=new Date;t.setDate(this.daterange.checkinDate.getDate()-60),this.options={autoApply:!0,locale:{format:"DD MMM,YY"},minDate:t,maxDate:o,startDate:this.daterange.checkinDate,endDate:this.daterange.checkoutDate,alwaysShowCalendars:!1}},o.prototype.selectedDate=function(o){this.daterange.checkinDate=o.start._d,this.daterange.checkoutDate=o.end._d,this.daterange.label=o.label,this.getAdminAvailableRoomList(this.hotel.id,this.daterange.checkinDate,this.daterange.checkoutDate)},o.prototype.reload=function(o,t,n){this.getAdminAvailableRoomList(o,t,n)},o.prototype.getAdminAvailableRoomList=function(o,t,n,e){return void 0===e&&(e=null),i=this,void 0,c=function(){var i,r,c=this;return function(o,t){var n,e,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,e&&(i=2&r[0]?e.return:r[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,r[1])).done)return i;switch(e=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,e=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(o,c)}catch(a){r=[6,a],e=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,function(a){switch(a.label){case 0:return i=this.util.getDateString(t),r=this.util.getDateString(n),this.showRoomListLoading=!0,this.message="Room List loading",[4,this.roomService.getAdminAvailableRoomListByHotelId(o,i,r,e).subscribe(function(o){c.showRoomListLoading=!1,c.roomList=o,c.filteredRoomList=o,c.category="All",c.categoryList=["All"],c.roomList.forEach(function(o){c.categoryList.includes(o.category.name)||c.categoryList.push(o.category.name)})})];case 1:return a.sent(),[2]}})},new((r=void 0)||(r=Promise))(function(o,t){function n(o){try{a(c.next(o))}catch(n){t(n)}}function e(o){try{a(c.throw(o))}catch(n){t(n)}}function a(t){var i;t.done?o(t.value):(i=t.value,i instanceof r?i:new r(function(o){o(i)})).then(n,e)}a((c=c.apply(i,[])).next())});var i,r,c},o.prototype.onSelectCategory=function(o){this.category=o,this.filteredRoomList="All"==o?this.roomList:this.roomList.filter(function(t){return t.category.name==o})},o.prototype.onRoomSelect=function(o,t){if(t){var n=this.roomList.find(function(t){return t.id===o}),e=m({selected:!0},n);this.roomList.splice(this.roomList.findIndex(function(t){return t.id==o}),1,e);var i={room:n,checkInDate:new Date(this.daterange.checkinDate),checkOutDate:new Date(this.daterange.checkoutDate)};this.roomSelected.emit(i)}},o.prototype.onHotelList=function(){this.showHotels.emit(!0)},o.\u0275fac=function(t){return new(t||o)(l.Ob(d.a),l.Ob(e.a))},o.\u0275cmp=l.Ib({type:o,selectors:[["admin-available-room-list"]],inputs:{hotel:"hotel",unSelect:"unSelect",reloadRoomList:"reloadRoomList"},outputs:{showHotels:"showHotels",roomSelected:"roomSelected"},features:[l.zb],decls:13,vars:3,consts:[[1,"container-fluid"],[1,"row"],[1,"col-9"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"fa","fa-calendar"],["type","text","name","daterangeInput","daterangepicker","",1,"form-control",3,"options","selected"],[4,"ngIf","ngIfElse"],["roomListLoading",""],[1,"btn","btn-sm","btn-info",3,"click"],[1,"row","mt-1"],[1,"col-12"],[4,"ngFor","ngForOf"],[1,"row","m-0"],["class","col-md-2 col-4 p-0",4,"ngFor","ngForOf"],[1,"btn-sm","m-1",3,"ngClass","click"],[1,"col-md-2","col-4","p-0"],[1,"room-box",3,"ngClass","click"],[3,"message"]],template:function(o,t){if(1&o&&(l.Tb(0,"div",0),l.Tb(1,"div",1),l.Tb(2,"div",2),l.Tb(3,"div",3),l.Tb(4,"div",4),l.Tb(5,"div",5),l.Pb(6,"i",6),l.Sb(),l.Sb(),l.Tb(7,"input",7),l.ec("selected",function(o){return t.selectedDate(o)}),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Ec(8,k,8,3,"div",8),l.Ec(9,y,1,1,"ng-template",null,9,l.Fc),l.Tb(11,"button",10),l.ec("click",function(){return t.onHotelList()}),l.Gc(12," Back to hotel list "),l.Sb(),l.Sb()),2&o){var n=l.yc(10);l.Bb(7),l.oc("options",t.options),l.Bb(1),l.oc("ngIf",!t.showRoomListLoading)("ngIfElse",n)}},directives:[f.b,u.p,u.o,u.n,h.a],styles:[".room-box[_ngcontent-%COMP%]{cursor:pointer;padding:5px;border:1px solid grey;border-radius:5px;text-align:center;margin:10px 10px 10px 0}.disabled[_ngcontent-%COMP%]{cursor:not-allowed;background-color:#d3d3d3!important}.selected[_ngcontent-%COMP%]{background-color:#90ee90;color:#fff}"]}),o}(),B=n("3Pt+");function w(o,t){1&o&&(l.Tb(0,"small",12),l.Gc(1," Name required "),l.Sb())}function I(o,t){if(1&o&&(l.Tb(0,"small",12),l.Tb(1,"div",13),l.Gc(2," Phone number required "),l.Sb(),l.Tb(3,"div",13),l.Gc(4," Phone number format 01934953023 "),l.Sb(),l.Sb()),2&o){var n=l.gc();l.Bb(1),l.oc("hidden",!n.form.controls.phoneNumber.errors.required),l.Bb(2),l.oc("hidden",!n.form.controls.phoneNumber.errors.pattern)}}var x=function(o){return{disabled:o}},D=function(){function o(o){this.builder=o,this.user=new l.n}return o.prototype.ngOnInit=function(){this.createForm()},o.prototype.createForm=function(){this.form=this.builder.group({name:["",B.v.required],phoneNumber:["",[B.v.required,B.v.pattern("^01[3-9][ ]?[0-9]{2}[ ]?[0-9]{3}[ ]?[0-9]{3}$")]],email:""})},o.prototype.submit=function(){this.form.valid&&(this.user.emit(this.form.value),this.form.reset())},o.\u0275fac=function(t){return new(t||o)(l.Ob(B.d))},o.\u0275cmp=l.Ib({type:o,selectors:[["admin-user-form"]],outputs:{user:"user"},decls:21,vars:6,consts:[[3,"formGroup","ngSubmit"],[1,"form-row"],[1,"form-group","col-md-6"],["for","name"],["id","name","placeholder","Name","formControlName","name",1,"form-control"],["class","text-danger",4,"ngIf"],["for","phone"],["placeholder","Phone","id","phone","maxlength","11","formControlName","phoneNumber",1,"form-control"],["for","email"],["type","email","id","email","placeholder","Email","formControlName","email",1,"form-control"],[1,"d-flex","flex-row-reverse","bd-highlight","my-2","mb-5"],["type","submit",1,"btn","btn-primary","mx-1",3,"ngClass"],[1,"text-danger"],[3,"hidden"]],template:function(o,t){1&o&&(l.Tb(0,"h4"),l.Gc(1,"User Info"),l.Sb(),l.Tb(2,"form",0),l.ec("ngSubmit",function(){return t.submit()}),l.Tb(3,"div",1),l.Tb(4,"div",2),l.Tb(5,"label",3),l.Gc(6,"Name *"),l.Sb(),l.Pb(7,"input",4),l.Ec(8,w,2,0,"small",5),l.Sb(),l.Tb(9,"div",2),l.Tb(10,"label",6),l.Gc(11,"Phone *"),l.Sb(),l.Pb(12,"input",7),l.Ec(13,I,5,2,"small",5),l.Sb(),l.Tb(14,"div",2),l.Tb(15,"label",8),l.Gc(16,"Email"),l.Sb(),l.Pb(17,"input",9),l.Sb(),l.Sb(),l.Tb(18,"div",10),l.Tb(19,"button",11),l.Gc(20," Submit "),l.Sb(),l.Sb(),l.Sb()),2&o&&(l.Bb(2),l.oc("formGroup",t.form),l.Bb(6),l.oc("ngIf",t.form.controls.name.errors&&t.form.controls.name.touched),l.Bb(5),l.oc("ngIf",t.form.controls.phoneNumber.errors&&t.form.controls.phoneNumber.touched),l.Bb(6),l.oc("ngClass",l.sc(4,x,t.form.invalid)))},directives:[B.x,B.n,B.g,B.b,B.m,B.f,u.p,B.j,u.n],styles:[""]}),o}(),O=function(){return(O=Object.assign||function(o){for(var t,n=1,e=arguments.length;n<e;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};function G(o,t){if(1&o){var n=l.Ub();l.Tb(0,"admin-hotel-list",5),l.ec("hotel",function(o){return l.zc(n),l.gc().onHotel(o)}),l.Sb()}}function R(o,t){if(1&o){var n=l.Ub();l.Tb(0,"div",6),l.Tb(1,"div",7),l.Tb(2,"div",8),l.Tb(3,"div",9),l.ec("click",function(){return l.zc(n),l.yc(7).toggle()}),l.Tb(4,"div",10),l.Pb(5,"i",11),l.Sb(),l.Sb(),l.Tb(6,"input",12,13),l.ec("ngModelChange",function(o){return l.zc(n),l.gc().dd=o})("dateSelect",function(){l.zc(n);var o=l.gc();return o.getAdminBookingList(o.hotelId,o.dd)})("click",function(){return l.zc(n),l.yc(7).toggle()}),l.Sb(),l.Sb(),l.Sb(),l.Sb()}if(2&o){var e=l.gc();l.Bb(6),l.oc("ngModel",e.dd)("minDate",e.minDate)("maxDate",e.maxDate)}}var L=function(o,t,n,e,i){return{"bg-lightgray":o,"bg-yellow":t,"bg-green":n,"bg-red":e,"bg-white":i}};function C(o,t){if(1&o){var n=l.Ub();l.Tb(0,"div",17),l.Tb(1,"div",18),l.ec("click",function(){l.zc(n);var o=t.$implicit,e=l.gc(2);return e.onRoomClick(o.id,o.bookingId,e.dd)}),l.Gc(2),l.Pb(3,"br"),l.Sb(),l.Sb()}if(2&o){var e=t.$implicit;l.Bb(1),l.oc("ngClass",l.wc(2,L,"ROOM_BLOCKED"===e.status,"ROOM_BOOKED"===e.status,"ROOM_RESERVED"===e.status,"ROOM_SOLD"===e.status,"ROOM_FREE"===e.status)),l.Bb(1),l.Ic(" ",e.roomNumber," ")}}function P(o,t){if(1&o&&(l.Tb(0,"div",14),l.Tb(1,"div",15),l.Tb(2,"h4"),l.Gc(3),l.Sb(),l.Sb(),l.Ec(4,C,4,8,"div",16),l.Sb()),2&o){var n=l.gc();l.Bb(3),l.Hc(n.hotel.name),l.Bb(1),l.oc("ngForOf",n.roomList)}}function M(o,t){1&o&&(l.Tb(0,"div",19),l.Tb(1,"div",20),l.Pb(2,"div",21),l.Gc(3," Blocked "),l.Sb(),l.Tb(4,"div",20),l.Pb(5,"div",22),l.Gc(6," Reserved "),l.Sb(),l.Tb(7,"div",20),l.Pb(8,"div",23),l.Gc(9," Sold "),l.Sb(),l.Tb(10,"div",20),l.Pb(11,"div",24),l.Gc(12," Free "),l.Sb(),l.Sb())}function E(o,t){if(1&o){var n=l.Ub();l.Tb(0,"button",25),l.ec("click",function(){return l.zc(n),l.gc().onHotelList()}),l.Pb(1,"i",26),l.Gc(2," Back to hotel list\n"),l.Sb()}}var A=function(){function o(o){this.roomService=o,this.roomSelected=new l.n,this.loading=!1,this.showRoomList=!1}return o.prototype.ngOnChanges=function(o){o.reload&&this.dd&&this.getAdminBookingList(this.hotelId,this.dd)},o.prototype.ngOnInit=function(){var o=new Date;this.dd={year:o.getFullYear(),month:o.getMonth()+1,day:o.getDate()},this.minDate={year:o.getFullYear(),month:o.getMonth()+1,day:o.getDate()-60},this.maxDate={year:o.getFullYear(),month:o.getMonth()+4,day:o.getDate()},this.maxDate.month>12&&(this.maxDate.year+=1,this.maxDate.month-=12)},o.prototype.getAdminBookingList=function(o,t){return n=this,void 0,i=function(){var n=this;return function(o,t){var n,e,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,e&&(i=2&r[0]?e.return:r[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,r[1])).done)return i;switch(e=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,e=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(o,c)}catch(a){r=[6,a],e=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,function(e){switch(e.label){case 0:return this.loading=!0,[4,this.roomService.getAdminBookingList(o,this.makeDateString(t)).subscribe(function(o){n.roomList=o,n.loading=!1})];case 1:return e.sent(),[2]}})},new((e=void 0)||(e=Promise))(function(o,t){function r(o){try{a(i.next(o))}catch(n){t(n)}}function c(o){try{a(i.throw(o))}catch(n){t(n)}}function a(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e(function(o){o(n)})).then(r,c)}a((i=i.apply(n,[])).next())});var n,e,i},o.prototype.onRoomClick=function(o,t,n){if(t>0){var e=this.roomList.find(function(t){return t.id==o});this.status=e.status;var i=O({date:n.year+"-"+(n.month+1)+"-"+n.day},e);this.roomSelected.emit(i)}},o.prototype.onHotel=function(o){this.hotelId=o.id,this.hotel=o,this.getAdminBookingList(o.id,this.dd),this.showRoomList=!0},o.prototype.onHotelList=function(){this.showRoomList=!1,localStorage.removeItem("hotelId")},o.prototype.makeDateString=function(o){return o.year+"-"+(o.month<10?"0"+o.month:o.month)+"-"+(o.day<10?"0"+o.day:o.day)},o.\u0275fac=function(t){return new(t||o)(l.Ob(d.a))},o.\u0275cmp=l.Ib({type:o,selectors:[["admin-room-status-date"]],inputs:{reload:"reload"},outputs:{roomSelected:"roomSelected"},features:[l.zb],decls:5,vars:5,consts:[[3,"hotel",4,"ngIf"],["class","row my-2",4,"ngIf"],["class","row",4,"ngIf"],["class","row border m-0 py-2",4,"ngIf"],["class","btn btn-sm btn-info mt-1",3,"click",4,"ngIf"],[3,"hotel"],[1,"row","my-2"],[1,"col-auto"],[1,"input-group","mb-2"],[1,"input-group-prepend",3,"click"],[1,"input-group-text"],[1,"fa","fa-calendar"],["placeholder","yyyy-mm-dd","name","dp","ngbDatepicker","",1,"form-control",3,"ngModel","minDate","maxDate","ngModelChange","dateSelect","click"],["date","ngbDatepicker"],[1,"row"],[1,"col-12"],["class","col-md-2 col-sm-3 col-3 p-1",4,"ngFor","ngForOf"],[1,"col-md-2","col-sm-3","col-3","p-1"],[1,"room-map-box",3,"ngClass","click"],[1,"row","border","m-0","py-2"],[1,"col-3"],[1,"foo","bg-lightgray"],[1,"foo","bg-green"],[1,"foo","bg-red"],[1,"foo","bg-white"],[1,"btn","btn-sm","btn-info","mt-1",3,"click"],[1,"fa","fa-chevron-left"]],template:function(o,t){1&o&&(l.Ec(0,G,1,0,"admin-hotel-list",0),l.Ec(1,R,8,3,"div",1),l.Ec(2,P,5,2,"div",2),l.Ec(3,M,13,0,"div",3),l.Ec(4,E,3,0,"button",4)),2&o&&(l.oc("ngIf",!t.showRoomList),l.Bb(1),l.oc("ngIf",t.showRoomList),l.Bb(1),l.oc("ngIf",t.showRoomList),l.Bb(1),l.oc("ngIf",null==t.roomList?null:t.roomList.length),l.Bb(1),l.oc("ngIf",t.showRoomList))},directives:[u.p,g.a,s.g,B.b,B.m,B.p,u.o,u.n],styles:[".room-map-box[_ngcontent-%COMP%]{cursor:pointer;margin-bottom:10px;padding:5px;text-align:center;border:1px solid grey;border-radius:5px}.room-map-box[_ngcontent-%COMP%]:hover{border:1px solid #4f71e0}.bg-lightgray[_ngcontent-%COMP%]{background-color:#d3d3d3!important}.bg-yellow[_ngcontent-%COMP%]{background-color:#ff0!important}.bg-green[_ngcontent-%COMP%]{color:#fff;background-color:green!important}.bg-red[_ngcontent-%COMP%]{color:#fff;background-color:red!important}.bg-white[_ngcontent-%COMP%]{background-color:#fff!important}.foo[_ngcontent-%COMP%]{float:left;width:20px;height:20px;margin:5px;border:1px solid grey}"]}),o}(),H=n("Xtf6"),_=n("V9jR"),z=function(){return(z=Object.assign||function(o){for(var t,n=1,e=arguments.length;n<e;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)},F=function(o,t,n,e){return new(n||(n=Promise))(function(i,r){function c(o){try{l(e.next(o))}catch(t){r(t)}}function a(o){try{l(e.throw(o))}catch(t){r(t)}}function l(o){var t;o.done?i(o.value):(t=o.value,t instanceof n?t:new n(function(o){o(t)})).then(c,a)}l((e=e.apply(o,t||[])).next())})},N=function(o,t){var n,e,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,e&&(i=2&r[0]?e.return:r[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,r[1])).done)return i;switch(e=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,e=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(o,c)}catch(a){r=[6,a],e=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};function U(o,t){if(1&o){var n=l.Ub();l.Tb(0,"admin-hotel-list",11),l.ec("hotel",function(o){return l.zc(n),l.gc(2).onHotel(o)}),l.Sb()}}function j(o,t){if(1&o){var n=l.Ub();l.Tb(0,"admin-available-room-list",12),l.ec("showHotels",function(o){return l.zc(n),l.gc(2).onShowHotels(o)})("roomSelected",function(o){return l.zc(n),l.gc(2).onRoomSelect(o)}),l.Sb()}if(2&o){var e=l.gc(2);l.oc("hotel",e.hotel)("unSelect",e.unSelect)("reloadRoomList",e.reloadRoomList)}}function $(o,t){1&o&&(l.Tb(0,"th",35),l.Gc(1," Commission "),l.Sb())}function V(o,t){if(1&o){var n=l.Ub();l.Tb(0,"td"),l.Tb(1,"input",44),l.ec("ngModelChange",function(o){return l.zc(n),l.gc().$implicit.commission=o}),l.Sb(),l.Sb()}if(2&o){var e=l.gc().$implicit;l.Bb(1),l.oc("ngModel",e.commission)}}function Y(o,t){if(1&o){var n=l.Ub();l.Tb(0,"tr"),l.Tb(1,"td"),l.Gc(2),l.Sb(),l.Tb(3,"td"),l.Gc(4),l.Sb(),l.Tb(5,"td"),l.Gc(6),l.Sb(),l.Tb(7,"td",35),l.Gc(8),l.Sb(),l.Tb(9,"td",35),l.Gc(10),l.Sb(),l.Tb(11,"td"),l.Tb(12,"input",40),l.ec("ngModelChange",function(o){return l.zc(n),t.$implicit.discount=o})("keyup",function(){l.zc(n);var o=t.index;return l.gc(4).updateSubBooking(o)}),l.Sb(),l.Sb(),l.Tb(13,"td",35),l.Gc(14),l.hc(15,"number"),l.Sb(),l.Tb(16,"td",35),l.Tb(17,"input",41),l.ec("ngModelChange",function(o){return l.zc(n),t.$implicit.advance=o})("keyup",function(){l.zc(n);var o=t.index;return l.gc(4).updateSubBooking(o)}),l.Sb(),l.Sb(),l.Tb(18,"td",35),l.Gc(19),l.Sb(),l.Ec(20,V,2,1,"td",39),l.Tb(21,"td"),l.Tb(22,"button",42),l.ec("click",function(){l.zc(n);var o=t.index;return l.gc(4).onRemove(o)}),l.Pb(23,"i",43),l.Sb(),l.Sb(),l.Sb()}if(2&o){var e=t.$implicit,i=l.gc(4);l.Bb(2),l.Hc(e.room.category.hotel.name),l.Bb(2),l.Hc(e.date),l.Bb(2),l.Jc("",e.room.roomNumber," [",e.room.category.name,"]"),l.Bb(2),l.Hc(e.room.price),l.Bb(2),l.Ic("",e.room.vatService," %"),l.Bb(2),l.oc("ngModel",e.discount),l.Bb(2),l.Ic(" ",l.jc(15,11,e.payablePrice,"1.1-2")," "),l.Bb(3),l.oc("ngModel",e.advance),l.Bb(2),l.Hc(null==e?null:e.due),l.Bb(1),l.oc("ngIf",(null==i.refBy?null:i.refBy.length)>0)}}function q(o,t){1&o&&l.Pb(0,"td")}function J(o,t){1&o&&l.Pb(0,"td")}function K(o,t){1&o&&l.Pb(0,"td")}function X(o,t){1&o&&l.Pb(0,"td")}function W(o,t){if(1&o&&(l.Tb(0,"table",34),l.Tb(1,"thead"),l.Tb(2,"tr"),l.Tb(3,"th"),l.Gc(4,"Hotel"),l.Sb(),l.Tb(5,"th"),l.Gc(6,"Date"),l.Sb(),l.Tb(7,"th"),l.Gc(8,"Room No."),l.Sb(),l.Tb(9,"th",35),l.Gc(10,"Per night"),l.Sb(),l.Tb(11,"th",35),l.Gc(12,"Vat & Service"),l.Sb(),l.Tb(13,"th",35),l.Gc(14,"Discount"),l.Sb(),l.Tb(15,"th",35),l.Gc(16,"Payable"),l.Sb(),l.Tb(17,"th",35),l.Gc(18,"Advance"),l.Sb(),l.Tb(19,"th",35),l.Gc(20,"Due"),l.Sb(),l.Ec(21,$,2,0,"th",36),l.Pb(22,"th"),l.Sb(),l.Sb(),l.Tb(23,"tbody"),l.Ec(24,Y,24,14,"tr",37),l.Sb(),l.Tb(25,"tfoot"),l.Tb(26,"tr"),l.Tb(27,"th",38),l.Gc(28,"Vat and Service Charge"),l.Sb(),l.Tb(29,"th",35),l.Gc(30),l.Sb(),l.Pb(31,"td"),l.Ec(32,q,1,0,"td",39),l.Sb(),l.Tb(33,"tr"),l.Tb(34,"th",38),l.Gc(35,"Total"),l.Sb(),l.Tb(36,"th",35),l.Gc(37),l.Sb(),l.Pb(38,"td"),l.Ec(39,J,1,0,"td",39),l.Sb(),l.Tb(40,"tr"),l.Tb(41,"th",38),l.Gc(42,"Total Advance"),l.Sb(),l.Tb(43,"th",35),l.Gc(44),l.Sb(),l.Pb(45,"td"),l.Ec(46,K,1,0,"td",39),l.Sb(),l.Tb(47,"tr"),l.Tb(48,"th",38),l.Gc(49,"Total due"),l.Sb(),l.Tb(50,"th",35),l.Gc(51),l.Sb(),l.Pb(52,"td"),l.Ec(53,X,1,0,"td",39),l.Sb(),l.Sb(),l.Sb()),2&o){var n=l.gc(3);l.Bb(21),l.oc("ngIf",(null==n.refBy?null:n.refBy.length)>0),l.Bb(3),l.oc("ngForOf",n.subBookings),l.Bb(6),l.Ic("",null==n.booking?null:n.booking.totalVatService," BDT"),l.Bb(2),l.oc("ngIf",(null==n.refBy?null:n.refBy.length)>0),l.Bb(5),l.Ic("",null==n.booking?null:n.booking.total," BDT"),l.Bb(2),l.oc("ngIf",(null==n.refBy?null:n.refBy.length)>0),l.Bb(5),l.Ic("",null==n.booking?null:n.booking.totalAdvance," BDT"),l.Bb(2),l.oc("ngIf",(null==n.refBy?null:n.refBy.length)>0),l.Bb(5),l.Ic("",null==n.booking?null:n.booking.totalDue," BDT"),l.Bb(2),l.oc("ngIf",(null==n.refBy?null:n.refBy.length)>0)}}function Z(o,t){if(1&o){var n=l.Ub();l.Tb(0,"admin-user-form",45),l.ec("user",function(o){return l.zc(n),l.gc(3).onCreateUser(o)}),l.Sb()}}var Q=function(o,t){return{"btn-primary active":o,"btn-light":t}};function oo(o,t){if(1&o){var n=l.Ub();l.Tb(0,"div",13),l.Tb(1,"div",14),l.Tb(2,"label",15),l.Tb(3,"input",16),l.ec("ngModelChange",function(o){return l.zc(n),l.gc(2).mode=o}),l.Sb(),l.Gc(4," Sell "),l.Sb(),l.Tb(5,"label",17),l.Tb(6,"input",18),l.ec("ngModelChange",function(o){return l.zc(n),l.gc(2).mode=o}),l.Sb(),l.Gc(7," Reserve "),l.Sb(),l.Sb(),l.Tb(8,"h3",19),l.Gc(9,"New Booking"),l.Sb(),l.Tb(10,"div",20),l.Pb(11,"div",21),l.Tb(12,"div",22),l.Tb(13,"div",23),l.Tb(14,"input",24),l.ec("ngModelChange",function(o){return l.zc(n),l.gc(2).changeSimilar=o}),l.Sb(),l.Tb(15,"label",25),l.Gc(16," Auto Change Similar Category "),l.Sb(),l.Sb(),l.Sb(),l.Tb(17,"div",22),l.Tb(18,"div",26),l.Tb(19,"div",27),l.Tb(20,"div",28),l.Gc(21,"Ref. By"),l.Sb(),l.Sb(),l.Tb(22,"input",29),l.ec("ngModelChange",function(o){return l.zc(n),l.gc(2).refBy=o}),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(23,"div",30),l.Tb(24,"div",31),l.Tb(25,"h5"),l.Gc(26,"Booking List"),l.Sb(),l.Sb(),l.Sb(),l.Ec(27,W,54,10,"table",32),l.Ec(28,Z,1,0,"admin-user-form",33),l.Sb()}if(2&o){var e=l.gc(2);l.Bb(2),l.oc("ngClass",l.tc(9,Q,"Sell"==e.mode,"Sell"!=e.mode)),l.Bb(1),l.oc("ngModel",e.mode),l.Bb(2),l.oc("ngClass",l.tc(12,Q,"Reserve"==e.mode,"Reserve"!=e.mode)),l.Bb(1),l.oc("ngModel",e.mode),l.Bb(8),l.oc("ngModel",e.changeSimilar),l.Bb(8),l.oc("ngModel",e.refBy),l.Bb(5),l.oc("ngIf",!e.sendingInfo)("ngIfElse",e.sending),l.Bb(1),l.oc("ngIf",!e.sendingInfo)}}function to(o,t){if(1&o&&(l.Tb(0,"div",6),l.Tb(1,"div",7),l.Ec(2,U,1,0,"admin-hotel-list",8),l.Ec(3,j,1,3,"admin-available-room-list",9),l.Sb(),l.Ec(4,oo,29,15,"div",10),l.Sb()),2&o){var n=l.gc();l.Bb(2),l.oc("ngIf",!n.showRoomList),l.Bb(1),l.oc("ngIf",n.showRoomList),l.Bb(1),l.oc("ngIf",n.subBookings.length>0)}}function no(o,t){1&o&&l.Gc(0,"Room status")}function eo(o,t){if(1&o&&l.Pb(0,"booking-info",53),2&o){var n=l.gc(3);l.oc("booking",n.reservation)}}function io(o,t){if(1&o){var n=l.Ub();l.Tb(0,"div",54),l.Tb(1,"a",55),l.Pb(2,"i",56),l.Gc(3," Print"),l.Sb(),l.Tb(4,"button",57),l.ec("click",function(){l.zc(n);var o=l.gc(3);return o.onCancelBooking(o.reservation.id)}),l.Gc(5," Cancel Booking "),l.Sb(),l.Sb()}if(2&o){var e=l.gc(3);l.Bb(1),l.qc("routerLink","/dashboard/printTicket/",e.reservation.id,"")}}function ro(o,t){if(1&o){var n=l.Ub();l.Tb(0,"booking-form",58),l.ec("onBooking",function(o){return l.zc(n),l.gc(3).onConfirmRerservation(o)})("cancelBooking",function(o){return l.zc(n),l.gc(3).onCancelRerservation(o)}),l.Sb()}if(2&o){var e=l.gc(3);l.oc("booking",e.reservation)}}var co=function(o,t){return{"bg-danger":o,"bg-primary":t}};function ao(o,t){if(1&o&&(l.Tb(0,"div",13),l.Tb(1,"div",49),l.Gc(2),l.Sb(),l.Ec(3,eo,1,1,"booking-info",50),l.Ec(4,io,6,1,"div",51),l.Ec(5,ro,1,1,"booking-form",52),l.Sb()),2&o){var n=l.gc(2);l.Bb(1),l.oc("ngClass",l.tc(5,co,"ROOM_SOLD"==(null==n.reservation?null:n.reservation.bookingStatus),"ROOM_RESERVED"==(null==n.reservation?null:n.reservation.bookingStatus))),l.Bb(1),l.Ic(" ","ROOM_SOLD"==(null==n.reservation?null:n.reservation.bookingStatus)?"Booking Details":"Reservation Details"," "),l.Bb(1),l.oc("ngIf","ROOM_SOLD"==(null==n.reservation?null:n.reservation.bookingStatus)),l.Bb(1),l.oc("ngIf","ROOM_SOLD"==(null==n.reservation?null:n.reservation.bookingStatus)),l.Bb(1),l.oc("ngIf","ROOM_RESERVED"==(null==n.reservation?null:n.reservation.bookingStatus))}}function lo(o,t){if(1&o){var n=l.Ub();l.Tb(0,"div",46),l.Tb(1,"div",47),l.Tb(2,"admin-room-status-date",48),l.ec("roomSelected",function(o){return l.zc(n),l.gc().onRoomSelectFromRoomStatus(o)}),l.Sb(),l.Sb(),l.Ec(3,ao,6,8,"div",10),l.Sb()}if(2&o){var e=l.gc();l.Bb(3),l.oc("ngIf",e.reservation)}}var bo=function(){function o(o,t,n,e){this.utilService=o,this.userService=t,this.bookingService=n,this.router=e,this.subBookings=[],this.reloadRoomList=!1,this.showRoomList=!1,this.sendingInfo=!1,this.changeSimilar=!0,this.message="",this.mode="Sell"}return o.prototype.ngOnInit=function(){this.booking={total:0,totalAdvance:0,totalDue:0}},o.prototype.onHotel=function(o){this.hotel=o,this.hotelId=o.id,this.showRoomList=!0},o.prototype.onShowHotels=function(o){this.showRoomList=!o,localStorage.removeItem("hotelId")},o.prototype.onRoomSelect=function(o){var t=this;this.utilService.getDatesBetween(o.checkInDate,o.checkOutDate).forEach(function(n){var e=new i.a(n,o.room);e.room.discount>0&&(e.discount=e.room.discount),t.isContain(e)||(t.subBookings.push(e),t.updateSubBooking(t.subBookings.length-1),t.subBookings.sort(t.utilService.dynamicSortObject("date")),t.subBookings.sort(t.utilService.dynamicSortObject("room.roomNumber")))})},o.prototype.onCreateUser=function(o){var t=z({id:0},o);this.createBooking(t)},o.prototype.createBooking=function(o){var t=this,n=new r.a(o,this.subBookings),e=z({total:this.booking.total,totalAdvance:this.booking.totalAdvance,totalDue:this.booking.totalDue},n);switch(this.message="generating booking",this.sendingInfo=!0,this.mode){case"Sell":this.bookingService.createAdminBooking(e).subscribe(function(o){t.message="Booking generated, Thank you.",t.sendingInfo=!1,t.booking.subBookingList=[],t.subBookings=[],t.ngOnInit(),t.reloadRoomList=!t.reloadRoomList,t.router.navigate(["/dashboard/printTicket",o.id])});break;case"Reserve":this.bookingService.reserveAdminBooking(e).subscribe(function(o){t.message="Booking complete, Thank you.",t.sendingInfo=!1,t.reloadRoomList=!t.reloadRoomList,t.ngOnInit(),t.router.navigate(["/dashboard/printTicket",o.id])})}},o.prototype.onReload=function(){this.reloadRoomList=!this.reloadRoomList},o.prototype.isContain=function(o){return this.subBookings.find(function(t){return t.room.id===o.room.id&&t.date===o.date&&t.room.category.hotel.id===o.room.category.hotel.id})},o.prototype.onRemove=function(o){this.unSelect=this.subBookings[o].room.id,this.subBookings.splice(o,1),this.updateBooking(o)},o.prototype.updateSubBooking=function(o){var t=this.subBookings[o];t.payablePrice=Math.round((t.room.price-t.discount)*(1+t.room.vatService/100)),t.due=t.payablePrice-t.advance,this.updateBooking(o)},o.prototype.updateBooking=function(o){var t=0,n=0,e=0,i=0;if(this.changeSimilar){var r=this.subBookings[o];this.subBookings.forEach(function(o){o.room.category.id==r.room.category.id&&(o.discount=r.discount,o.advance=r.advance,o.payablePrice=Math.round((o.room.price-o.discount)*(1+o.room.vatService/100)),o.due=o.payablePrice-o.advance)})}this.subBookings.forEach(function(o){t+=o.payablePrice,n+=o.advance,e+=o.due,i+=o.room.vatService/100*(o.room.price-o.discount)}),this.booking.totalVatService=i,this.booking.total=t,this.booking.totalAdvance=n,this.booking.totalDue=e},o.prototype.onRoomSelectFromRoomStatus=function(o){return F(this,void 0,void 0,function(){var t=this;return N(this,function(n){switch(n.label){case 0:return[4,this.bookingService.getAdminBooking(o.bookingId).subscribe(function(o){t.reservation=o})];case 1:return n.sent(),[2]}})})},o.prototype.onConfirmRerservation=function(o){return F(this,void 0,void 0,function(){var t=this;return N(this,function(n){switch(n.label){case 0:return confirm("Are you sure to confirm reservation with id : "+o.id)?[4,this.bookingService.confirmAdminReservation(o).subscribe(function(o){t.reservation=null,console.log(o),console.log("Confirm Reservation Done")})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},o.prototype.onCancelRerservation=function(o){return F(this,void 0,void 0,function(){var t=this;return N(this,function(n){switch(n.label){case 0:return console.log("onCancelRerservation ",o),confirm("Are you sure to cancel reservation with id : "+o)?[4,this.bookingService.cancelAdminReservation(o).subscribe(function(o){t.reservation=null,console.log("Cancel Reservation done")})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},o.prototype.onCancelBooking=function(o){return F(this,void 0,void 0,function(){var t=this;return N(this,function(n){return confirm("Are you sure to cancel booking with id : "+o)&&(console.log("cancel booking : ",o),this.bookingService.cancelAdminBooking(o).subscribe(function(o){console.log(o),console.log("Booking canceled"),t.reservation=null})),[2]})})},o.prototype.getMySells=function(){return F(this,void 0,void 0,function(){return N(this,function(o){return[2]})})},o.\u0275fac=function(t){return new(t||o)(l.Ob(e.a),l.Ob(c.a),l.Ob(a.a),l.Ob(b.b))},o.\u0275cmp=l.Ib({type:o,selectors:[["app-admin-sell-room"]],decls:10,vars:0,consts:[[1,"container-fluid","d-print-none"],[1,"row","px-3","details-title","text-left"],[1,"container-fluid"],["title","Sell room",1,"d-print-none"],["ngbTabContent",""],["class","d-print-none","ngbTabTitle",""],[1,"row","m-0","py-2"],[1,"col-md-4","p-0"],[3,"hotel",4,"ngIf"],[3,"hotel","unSelect","reloadRoomList","showHotels","roomSelected",4,"ngIf"],["class","col-md-8",4,"ngIf"],[3,"hotel"],[3,"hotel","unSelect","reloadRoomList","showHotels","roomSelected"],[1,"col-md-8"],["data-toggle","buttons",1,"btn-group","btn-group-toggle","border"],[1,"btn",3,"ngClass"],["type","radio","value","Sell","name","mode","id","mode_sell","autocomplete","off",3,"ngModel","ngModelChange"],[1,"btn","btn-primary",3,"ngClass"],["type","radio","value","Reserve","name","mode","id","mode_reservation","autocomplete","off",3,"ngModel","ngModelChange"],[1,"text-center"],[1,"row"],[1,"col-md-6"],[1,"col-md-3"],[1,"form-check","mb-2"],["type","checkbox","id","changeSimilar",1,"form-check-input",3,"ngModel","ngModelChange"],["for","changeSimilar",1,"form-check-label"],[1,"input-group","mb-2"],[1,"input-group-prepend"],[1,"input-group-text"],["type","text","id","refBy",1,"form-control",3,"ngModel","ngModelChange"],[1,"row","m-0"],[1,"col-12","bg-primary","text-white","text-center"],["class","table mb-4 border table-responsive-sm",4,"ngIf","ngIfElse"],[3,"user",4,"ngIf"],[1,"table","mb-4","border","table-responsive-sm"],[1,"text-right"],["class","text-right",4,"ngIf"],[4,"ngFor","ngForOf"],["colspan","8",1,"text-right"],[4,"ngIf"],["type","number","name","totalDiscount",1,"form-control","float-right","text-right",3,"ngModel","ngModelChange","keyup"],["type","number","name","advance",1,"form-control","float-right","text-right",3,"ngModel","ngModelChange","keyup"],[1,"btn-sm","btn-danger",3,"click"],[1,"fa","fa-trash-o"],["type","number","name","commission",1,"form-control","float-right","text-right",3,"ngModel","ngModelChange"],[3,"user"],[1,"mt-2","row"],[1,"col-md-4"],[3,"roomSelected"],[1,"p-3","mb-2","text-white",3,"ngClass"],[3,"booking",4,"ngIf"],["class","d-flex flex-row-reverse bd-highlight mb-4",4,"ngIf"],[3,"booking","onBooking","cancelBooking",4,"ngIf"],[3,"booking"],[1,"d-flex","flex-row-reverse","bd-highlight","mb-4"],[1,"btn","btn-sm","btn-primary","mx-1",3,"routerLink"],[1,"fa","fa-print"],[1,"btn","btn-sm","btn-danger",3,"click"],[3,"booking","onBooking","cancelBooking"]],template:function(o,t){1&o&&(l.Tb(0,"div",0),l.Tb(1,"span",1),l.Gc(2,"Sell room"),l.Sb(),l.Sb(),l.Tb(3,"div",2),l.Tb(4,"ngb-tabset"),l.Tb(5,"ngb-tab",3),l.Ec(6,to,5,3,"ng-template",4),l.Sb(),l.Tb(7,"ngb-tab"),l.Ec(8,no,1,0,"ng-template",5),l.Ec(9,lo,4,1,"ng-template",4),l.Sb(),l.Sb(),l.Sb())},directives:[s.n,s.k,s.l,s.m,u.p,g.a,T,u.n,B.s,B.b,B.m,B.p,B.a,u.o,B.r,D,A,H.a,b.d,_.a],pipes:[u.g],styles:[".table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.15rem}.form-control[_ngcontent-%COMP%]{max-width:90px;padding:.15rem .5rem;height:calc(1.75rem + 2px)}"]}),o}(),so=n("3whx"),uo=function(){return(uo=Object.assign||function(o){for(var t,n=1,e=arguments.length;n<e;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(o[i]=t[i]);return o}).apply(this,arguments)};function go(o,t){if(1&o){var n=l.Ub();l.Tb(0,"a",10),l.ec("click",function(){l.zc(n);var o=t.$implicit;return l.gc(2).onSelectBooking(o.id)}),l.Gc(1),l.hc(2,"date"),l.Sb()}if(2&o){var e=t.$implicit;l.Bb(1),l.Kc(" [",e.id,"] ",e.user.name," - ",l.jc(2,3,e.created,"MMM d, y, h:mm:ss a")," ")}}function fo(o,t){if(1&o&&(l.Tb(0,"ul",7),l.Tb(1,"li",8),l.Tb(2,"h5"),l.Gc(3,"Booking List"),l.Sb(),l.Tb(4,"small"),l.Gc(5,"Choose a booking from below list"),l.Sb(),l.Sb(),l.Ec(6,go,3,6,"a",9),l.Sb()),2&o){var n=l.gc();l.Bb(6),l.oc("ngForOf",n.offlineBookings)}}function ho(o,t){1&o&&l.Pb(0,"loading")}function mo(o,t){if(1&o){var n=l.Ub();l.Tb(0,"tr"),l.Tb(1,"td"),l.Gc(2),l.Sb(),l.Tb(3,"td"),l.Gc(4),l.hc(5,"date"),l.Sb(),l.Tb(6,"td"),l.Gc(7),l.Sb(),l.Tb(8,"td",15),l.Gc(9),l.Sb(),l.Tb(10,"td",15),l.Gc(11),l.Sb(),l.Tb(12,"td",15),l.Gc(13),l.Sb(),l.Tb(14,"td"),l.Tb(15,"button",19),l.ec("click",function(){l.zc(n);var o=t.index;return l.gc(3).removeRoom(o)}),l.Pb(16,"i",20),l.Sb(),l.Sb(),l.Sb()}if(2&o){var e=t.$implicit;l.Bb(2),l.Hc(null==e||null==e.room.category||null==e.room.category.hotel?null:e.room.category.hotel.name),l.Bb(2),l.Hc(l.jc(5,7,null==e?null:e.date,"d MMM,yy")),l.Bb(3),l.Jc(" ",null==e||null==e.room?null:e.room.roomNumber," [",null==e||null==e.room.category?null:e.room.category.name,"] "),l.Bb(2),l.Ic("",null==e||null==e.room?null:e.room.price," BDT"),l.Bb(2),l.Ic("",null==e?null:e.discount," BDT"),l.Bb(2),l.Ic("",null==e?null:e.payablePrice," BDT")}}function po(o,t){if(1&o&&(l.Tb(0,"tbody"),l.Ec(1,mo,17,10,"tr",18),l.Sb()),2&o){var n=l.gc(2);l.Bb(1),l.oc("ngForOf",n.booking.subBookingList)}}function vo(o,t){if(1&o){var n=l.Ub();l.Tb(0,"button",25),l.ec("click",function(){l.zc(n);var o=l.gc(3);return o.onConfirmBooking(o.booking.id)}),l.Pb(1,"i",26),l.Gc(2," Confirm booking "),l.Sb()}}function So(o,t){if(1&o){var n=l.Ub();l.Tb(0,"button",27),l.ec("click",function(){l.zc(n);var o=l.gc(3);return o.onDeleteBooking(o.booking.id)}),l.Pb(1,"i",28),l.Gc(2," Delete booking "),l.Sb()}}function ko(o,t){1&o&&l.Pb(0,"loading")}function yo(o,t){if(1&o&&(l.Tb(0,"div",21),l.Ec(1,vo,3,0,"button",22),l.Ec(2,So,3,0,"button",23),l.Ec(3,ko,1,0,"ng-template",null,24,l.Fc),l.Sb()),2&o){var n=l.yc(4),e=l.gc(2);l.Bb(1),l.oc("ngIf",!e.loading)("ngIfElse",n),l.Bb(1),l.oc("ngIf",!e.loading)}}function To(o,t){if(1&o&&(l.Tb(0,"div",11),l.Tb(1,"div",2),l.Tb(2,"div",12),l.Tb(3,"h3"),l.Gc(4,"Customer Info"),l.Sb(),l.Tb(5,"table"),l.Tb(6,"tr"),l.Tb(7,"th"),l.Gc(8,"Name :"),l.Sb(),l.Tb(9,"th"),l.Gc(10),l.Sb(),l.Sb(),l.Tb(11,"tr"),l.Tb(12,"th"),l.Gc(13,"Phone :"),l.Sb(),l.Tb(14,"th"),l.Gc(15),l.Sb(),l.Sb(),l.Tb(16,"tr"),l.Tb(17,"th"),l.Gc(18,"Email :"),l.Sb(),l.Tb(19,"th"),l.Gc(20),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Pb(21,"div",13),l.Tb(22,"div",12),l.Tb(23,"h3"),l.Gc(24,"Hotel Info"),l.Sb(),l.Tb(25,"table"),l.Tb(26,"tr"),l.Tb(27,"th"),l.Gc(28,"Name :"),l.Sb(),l.Tb(29,"td"),l.Gc(30),l.Sb(),l.Sb(),l.Tb(31,"tr"),l.Tb(32,"th"),l.Gc(33,"Phone :"),l.Sb(),l.Tb(34,"td"),l.Gc(35),l.Sb(),l.Sb(),l.Tb(36,"tr"),l.Tb(37,"th"),l.Gc(38,"Address:"),l.Sb(),l.Tb(39,"td"),l.Gc(40),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(41,"div",2),l.Tb(42,"table",14),l.Tb(43,"thead"),l.Tb(44,"tr"),l.Tb(45,"th"),l.Gc(46,"Hotel"),l.Sb(),l.Tb(47,"th"),l.Gc(48,"Date"),l.Sb(),l.Tb(49,"th"),l.Gc(50,"Room number"),l.Sb(),l.Tb(51,"th",15),l.Gc(52,"Per night"),l.Sb(),l.Tb(53,"th",15),l.Gc(54,"Discount"),l.Sb(),l.Tb(55,"th",15),l.Gc(56,"Payable"),l.Sb(),l.Pb(57,"th",15),l.Sb(),l.Sb(),l.Ec(58,po,2,1,"tbody",5),l.Tb(59,"tfoot"),l.Tb(60,"tr"),l.Tb(61,"th",16),l.Gc(62,"Sub total"),l.Sb(),l.Tb(63,"th",15),l.Gc(64),l.Sb(),l.Pb(65,"td"),l.Sb(),l.Tb(66,"tr"),l.Tb(67,"th",16),l.Gc(68,"Discount"),l.Sb(),l.Tb(69,"th",15),l.Gc(70),l.Sb(),l.Pb(71,"td"),l.Sb(),l.Tb(72,"tr"),l.Tb(73,"th",16),l.Gc(74,"Promotional Discount"),l.Sb(),l.Tb(75,"th",15),l.Gc(76),l.Sb(),l.Pb(77,"td"),l.Sb(),l.Tb(78,"tr"),l.Tb(79,"th",16),l.Gc(80,"Total"),l.Sb(),l.Tb(81,"th",15),l.Gc(82),l.Sb(),l.Pb(83,"td"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Ec(84,yo,5,3,"div",17),l.Sb()),2&o){var n=l.gc();l.Bb(10),l.Hc(null==n.booking||null==n.booking.user?null:n.booking.user.name),l.Bb(5),l.Hc(null==n.booking||null==n.booking.user?null:n.booking.user.phoneNumber),l.Bb(5),l.Hc(null==n.booking||null==n.booking.user?null:n.booking.user.email),l.Bb(10),l.Hc(null==n.booking?null:n.booking.hotels[0].name),l.Bb(5),l.Hc(null==n.booking?null:n.booking.hotels[0].phoneNumber),l.Bb(5),l.Hc(null==n.booking?null:n.booking.hotels[0].address.commaSeperatedString),l.Bb(18),l.oc("ngIf",null!=n.booking&&null!=n.booking.subBookingList&&n.booking.subBookingList.length>0),l.Bb(6),l.Ic("",null==n.booking?null:n.booking.subtotal," BDT"),l.Bb(6),l.Ic("",null==n.booking?null:n.booking.totalDiscount," BDT"),l.Bb(6),l.Ic("",null==n.booking?null:n.booking.promotionDiscount," BDT"),l.Bb(6),l.Ic("",null==n.booking?null:n.booking.total," BDT"),l.Bb(2),l.oc("ngIf",null!=(null==n.booking?null:n.booking.subBookingList)&&n.booking.subBookingList.length>0)}}var Bo=function(){function o(o){this.bookingService=o,this.loading=!1}return o.prototype.ngOnInit=function(){this.getOfflineBookings()},o.prototype.onSelectBooking=function(o){var t=this.offlineBookings.find(function(t){return t.id===o});this.booking=uo({},t)},o.prototype.getOfflineBookings=function(){return o=this,void 0,n=function(){var o=this;return function(o,t){var n,e,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,e&&(i=2&r[0]?e.return:r[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,r[1])).done)return i;switch(e=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,e=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(o,c)}catch(a){r=[6,a],e=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}(this,function(t){switch(t.label){case 0:return this.loading=!0,[4,this.bookingService.getOfflineBookings().subscribe(function(t){o.offlineBookings=t,o.loading=!1})];case 1:return t.sent(),[2]}})},new((t=void 0)||(t=Promise))(function(e,i){function r(o){try{a(n.next(o))}catch(t){i(t)}}function c(o){try{a(n.throw(o))}catch(t){i(t)}}function a(o){var n;o.done?e(o.value):(n=o.value,n instanceof t?n:new t(function(o){o(n)})).then(r,c)}a((n=n.apply(o,[])).next())});var o,t,n},o.prototype.onConfirmBooking=function(o){var t=this;console.log("CON",o),this.loading=!0,this.bookingService.confirmOfflineBookings(o).subscribe(function(o){console.log(o),t.booking=null,t.loading=!1,t.getOfflineBookings()})},o.prototype.onDeleteBooking=function(o){var t=this;this.loading=!0,this.bookingService.deleteOfflineBookings(o).subscribe(function(o){t.booking=null,t.loading=!1,t.getOfflineBookings()})},o.\u0275fac=function(t){return new(t||o)(l.Ob(a.a))},o.\u0275cmp=l.Ib({type:o,selectors:[["app-offline-bookings"]],decls:9,vars:3,consts:[[1,"container-fluid"],[1,"row","px-3","details-title","text-left"],[1,"row"],[1,"col-md-3"],["class","list-group",4,"ngIf"],[4,"ngIf"],["class","col-md-9",4,"ngIf"],[1,"list-group"],[1,"list-group-item"],["class","list-group-item list-group-item-action",3,"click",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action",3,"click"],[1,"col-md-9"],[1,"col-md-4","border","my-4","p-2"],[1,"col-md-4","my-4","p-2"],[1,"table","table-responsive-sm","border"],[1,"text-right"],["colspan","5",1,"text-right"],["class","d-flex flex-row-reverse bd-highlight mb-5",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fa","fa-trash-o"],[1,"d-flex","flex-row-reverse","bd-highlight","mb-5"],["class","btn btn-sm btn-success mx-2",3,"click",4,"ngIf","ngIfElse"],["class","btn btn-sm btn-danger mx-2",3,"click",4,"ngIf"],["loadMessage",""],[1,"btn","btn-sm","btn-success","mx-2",3,"click"],[1,"fa","fa-check"],[1,"btn","btn-sm","btn-danger","mx-2",3,"click"],[1,"fa","fa-trash"]],template:function(o,t){1&o&&(l.Tb(0,"div",0),l.Tb(1,"span",1),l.Gc(2,"Offline bookings"),l.Sb(),l.Sb(),l.Tb(3,"div",0),l.Tb(4,"div",2),l.Tb(5,"div",3),l.Ec(6,fo,7,1,"ul",4),l.Ec(7,ho,1,0,"loading",5),l.Sb(),l.Ec(8,To,85,12,"div",6),l.Sb(),l.Sb()),2&o&&(l.Bb(6),l.oc("ngIf",!t.loading),l.Bb(1),l.oc("ngIf",t.loading),l.Bb(1),l.oc("ngIf",t.booking))},directives:[u.p,u.o,h.a],pipes:[u.f],styles:[".list-group-item[_ngcontent-%COMP%]{cursor:pointer;padding:.15rem 1.25rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.15rem}"]}),o}(),wo=n("YBP9"),Io=function(o,t,n,e){return new(n||(n=Promise))(function(i,r){function c(o){try{l(e.next(o))}catch(t){r(t)}}function a(o){try{l(e.throw(o))}catch(t){r(t)}}function l(o){var t;o.done?i(o.value):(t=o.value,t instanceof n?t:new n(function(o){o(t)})).then(c,a)}l((e=e.apply(o,t||[])).next())})},xo=function(o,t){var n,e,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,e&&(i=2&r[0]?e.return:r[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,r[1])).done)return i;switch(e=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,e=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(o,c)}catch(a){r=[6,a],e=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};function Do(o,t){if(1&o){var n=l.Ub();l.Tb(0,"div",9),l.Tb(1,"button",10),l.ec("click",function(){l.zc(n);var o=l.gc(2);return o.onCancelBooking(o.booking.id)}),l.Pb(2,"i",11),l.Gc(3," Cancel booking "),l.Sb(),l.Sb()}}function Oo(o,t){if(1&o&&(l.Tb(0,"div",6),l.Pb(1,"admin-booking-details",7),l.Ec(2,Do,4,0,"div",8),l.Sb()),2&o){var n=l.gc();l.Bb(1),l.oc("booking",n.booking),l.Bb(1),l.oc("ngIf",null!=(null==n.booking?null:n.booking.subBookingList)&&n.booking.subBookingList.length>0)}}var Go=[{path:"sell-rooms",component:bo},{path:"offline-bookings",component:Bo},{path:"cancel-bookings",component:function(){function o(o,t){this.utilService=o,this.bookingService=t,this.showRoomList=!1,this.reload=!1}return o.prototype.ngOnInit=function(){},o.prototype.onHotel=function(o){this.hotelId=o.id,this.showRoomList=!0},o.prototype.onShowHotels=function(o){this.showRoomList=!o},o.prototype.onRoomSelect=function(o){this.getAdminBooking(o.bookingId)},o.prototype.getAdminBooking=function(o){return Io(this,void 0,void 0,function(){var t=this;return xo(this,function(n){switch(n.label){case 0:return null!=this.booking&&this.booking.id==o?[3,2]:[4,this.bookingService.getAdminBooking(o).subscribe(function(o){t.booking=o})];case 1:n.sent(),n.label=2;case 2:return[2]}})})},o.prototype.onCancelBooking=function(o){return Io(this,void 0,void 0,function(){var t=this;return xo(this,function(n){switch(n.label){case 0:return confirm("Are you sure to cancel booking with booking id "+o)?[4,this.bookingService.cancelAdminBooking(o).subscribe(function(o){console.log(o),t.booking=null,t.reload=!t.reload})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},o.\u0275fac=function(t){return new(t||o)(l.Ob(e.a),l.Ob(a.a))},o.\u0275cmp=l.Ib({type:o,selectors:[["app-cancel-bookings"]],decls:8,vars:2,consts:[[1,"container-fluid"],[1,"row","px-3","details-title","text-left"],[1,"row","m-0"],[1,"col-md-4","mb-5"],[3,"reload","roomSelected"],["class","col-md-8",4,"ngIf"],[1,"col-md-8"],[3,"booking"],["class","d-flex flex-row-reverse bd-highlight mb-5",4,"ngIf"],[1,"d-flex","flex-row-reverse","bd-highlight","mb-5"],[1,"btn","btn-sm","btn-success","mx-2",3,"click"],[1,"fa","fa-check"]],template:function(o,t){1&o&&(l.Tb(0,"div",0),l.Tb(1,"span",1),l.Gc(2,"Cancel Bookings"),l.Sb(),l.Sb(),l.Tb(3,"div",0),l.Tb(4,"div",2),l.Tb(5,"div",3),l.Tb(6,"admin-room-status-date",4),l.ec("roomSelected",function(o){return t.onRoomSelect(o)}),l.Sb(),l.Sb(),l.Ec(7,Oo,3,2,"div",5),l.Sb(),l.Sb()),2&o&&(l.Bb(6),l.oc("reload",t.reload),l.Bb(1),l.oc("ngIf",t.booking))},directives:[A,u.p,wo.a],styles:[""]}),o}()}],Ro=function(){function o(){}return o.\u0275mod=l.Mb({type:o}),o.\u0275inj=l.Lb({factory:function(t){return new(t||o)},imports:[[so.a,b.e.forChild(Go)]]}),o}()}}]);